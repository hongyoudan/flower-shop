webpackJsonp([27],{WF7O:function(e,t){},nhah:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={name:"Supplier",data:function(){return{supplierData:null,supplierResource:null,handleIndex:0,dialogFormVisible:!1,productTypeInfo:[],insert:!1,supplierForm:{key:""},alterForm:{supplierId:"",supplierNo:"",supplierName:"",productType:"",principal:"",contactWay:"",status:""},alterRules:{supplierName:[{required:!0,message:"请填写供应商名称",trigger:"blur"},{min:1,max:30,message:"名称长度不允许超过 30 个字符",trigger:"blur"}],productType:[{required:!0,message:"请选择商品分类",trigger:"blur"}],principal:[{required:!0,message:"请填写供应商负责人",trigger:"blur"}],contactWay:[{required:!0,message:"请填写联系方式",trigger:"blur"},{validator:function(e,t,r){if(!new RegExp("^((0\\d{2,3}-\\d{7,8})|(1[3584]\\d{9}))$").test(t))return r(new Error("请填写正确的联系方式"));r()},trigger:"blur"}]}}},methods:{resetForm:function(e){this.$refs[e].resetFields()},querySupplier:function(){if(0!==this.supplierForm.key.length){this.supplierData=[];for(var e=0,t=this.supplierResource.length;e<t;e++)-1!==this.supplierResource[e].supplierName.indexOf(this.supplierForm.key)&&this.supplierData.push(this.supplierResource[e])}else this.supplierData=this.supplierResource},isSupplierState:function(e){var t=this,r=this.$loading({lock:!0,text:"数据提交中",background:"rgba(255,255,255,0.2)"});this.$http.post("/supplier/updateSupplier?supplierId="+this.supplierData[e].supplierId+"&status="+this.supplierData[e].status).then(function(a){r.close(),200===a.data.code&&(t.supplierData[e].status?t.$notify({title:"成功",message:"供应商（"+t.supplierData[e].supplierName+"）\t已启用",type:"success"}):t.$notify({title:"成功",message:"供应商（"+t.supplierData[e].supplierName+"）\t已禁用",type:"success"}))}).catch(function(e){r.close(),t.$msg.error(e)})},openChange:function(e){this.handleIndex=e,this.insert=!1,this.alterForm=this.supplierData[e],this.dialogFormVisible=!0},deleteReason:function(e,t){var r=this,a=this.supplierData[e].supplierName;this.$confirm("此操作将永久删除该供应商信息, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var i=r.$loading({lock:!0,text:"数据提交中",background:"rgba(255,255,255,0.2)"});r.$http.post("/supplier/deleteSupplier?supplierId="+r.supplierData[e].supplierId).then(function(l){i.close(),200===l.data.code?(t.splice(e,1),r.$notify({title:"成功",message:"供应商("+a+")\t移除成功",type:"success"})):r.$notify({title:"错误",message:l.data.message,type:"error"})}).catch(function(e){i.close(),r.$msg.error(e)})}).catch(function(){r.$notify({title:"操作取消",message:"",type:"success"})})},addSupplier:function(){this.getDateNow(),delete this.alterForm.supplierId,this.handleIndex=-1,this.alterForm.supplierName="",this.alterForm.productType="",this.alterForm.principal="",this.alterForm.contactWay="",this.alterForm.status=!0,this.insert=!0,this.dialogFormVisible=!0},getDateNow:function(){var e=new Date,t=String(e.getFullYear()),r=String(e.getMonth()+1),a=String(e.getDate()),i=String(e.getHours());i.length<2&&(i="0"+i);var l=String(e.getMinutes());l.length<2&&(l="0"+l);var s=String(e.getSeconds());s.length<2&&(s="0"+s);var o=Math.floor(900*Math.random()+100+1);this.alterForm.supplierNo=t+r+a+i+l+s+o},submitChange:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.insert?t.$http.post("/supplier/existSupplier?supplierId=0&supplierName="+t.alterForm.supplierName).then(function(e){if(200===e.data.code)if(e.data.data)t.$alert("供应商("+t.alterForm.supplierName+")\t已存在，不能重复添加","警告",{confirmButtonText:"确定",type:"warning"});else{var r=t.$loading({lock:!0,text:"数据提交中",background:"rgba(255,255,255,0.1)"});t.$http.post("/supplier/addSupplier",t.$qs.stringify(t.alterForm)).then(function(e){r.close(),200===e.data.code?(t.dialogFormVisible=!1,t.reqInfo(),t.$notify({title:"成功",message:"供应商("+t.alterForm.supplierName+")\t添加成功",type:"success"})):t.$notify({title:"错误",message:e.data.message,type:"error"})}).catch(function(e){r.close(),t.$msg.error(e)})}}).catch(function(e){t.$msg.error(e)}):t.$http.post("/supplier/existSupplier?supplierId="+t.supplierData[t.handleIndex].supplierId+"&supplierName="+t.alterForm.supplierName).then(function(e){if(200===e.data.code)if(e.data.data)t.$alert("供应商("+t.alterForm.supplierName+")\t已存在，无法完成修改操作","警告",{confirmButtonText:"确定",type:"warning"});else{t.dialogFormVisible=!1;var r=t.$loading({lock:!0,text:"数据提交中",background:"rgba(255,255,255,0.1)"});t.$http.post("/supplier/updateSupplier",t.$qs.stringify(t.alterForm)).then(function(e){r.close(),200===e.data.code?(t.supplierData[t.handleIndex]=t.alterForm,t.$notify({title:"成功",message:"供应商("+t.alterForm.supplierName+")\t更新成功",type:"success"})):t.$notify({title:"错误",message:e.data.message,type:"error"})}).catch(function(e){r.close(),t.$msg.error(e)})}}).catch(function(e){t.$msg.error(e)})})},cancelChange:function(e){this.dialogFormVisible=!1,this.$refs[e].resetFields(),this.$notify({title:"操作取消",message:"",type:"success"})},reqInfo:function(){var e=this;this.$http.post("/supplier/findAll").then(function(t){200===t.data.code&&(e.supplierResource=e.supplierData=t.data.data)}).catch(function(t){e.$msg.error(t)}),this.$http.post("/productType/findAllName").then(function(t){200===t.data.code&&(e.productTypeInfo=t.data.data)}).catch(function(t){e.$msg.error(t)})}},created:function(){this.reqInfo()}},i={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"supplier"},[r("el-card",{staticClass:"supplier-hd",attrs:{shadow:"never"}},[r("div",{staticStyle:{"text-align":"left"},attrs:{slot:"header"},slot:"header"},[r("i",{staticClass:"el-icon-search"}),e._v(" "),r("span",[e._v("筛选搜索")]),e._v(" "),r("el-button",{staticClass:"el-button-search",staticStyle:{right:"111px"},attrs:{type:"primary"},on:{click:function(t){return e.querySupplier()}}},[e._v("查询")]),e._v(" "),r("el-button",{staticClass:"el-button-search",staticStyle:{right:"20px"},on:{click:function(t){return e.resetForm("supplierForm")}}},[e._v("重置")])],1),e._v(" "),r("el-form",{ref:"supplierForm",staticClass:"query-form",attrs:{model:e.supplierForm,inline:""}},[r("el-form-item",{attrs:{label:"输入搜索：",prop:"key"}},[r("el-input",{attrs:{clearable:"",placeholder:"供应商"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.querySupplier(t)}},model:{value:e.supplierForm.key,callback:function(t){e.$set(e.supplierForm,"key",t)},expression:"supplierForm.key"}})],1)],1)],1),e._v(" "),r("el-card",{staticClass:"supplier-box",attrs:{shadow:"never"}},[r("div",{staticStyle:{"text-align":"left",position:"relative"},attrs:{slot:"header"},slot:"header"},[r("i",{staticClass:"el-icon-coin"}),e._v(" "),r("span",[e._v("数据列表")]),e._v(" "),r("el-button",{staticClass:"el-button-add",on:{click:e.addSupplier}},[e._v("添加")])],1),e._v(" "),r("el-table",{staticClass:"type-table",staticStyle:{width:"100%","user-select":"text"},attrs:{data:e.supplierData,height:"425",border:""}},[r("el-table-column",{attrs:{prop:"supplierId",label:"编号",width:"100"}}),e._v(" "),r("el-table-column",{attrs:{prop:"supplierNo",label:"供应商编号",width:"180"}}),e._v(" "),r("el-table-column",{attrs:{prop:"supplierName",label:"供应商名称",width:"180"}}),e._v(" "),r("el-table-column",{attrs:{prop:"productType",label:"商品类别",width:"180"}}),e._v(" "),r("el-table-column",{attrs:{prop:"principal",label:"负责人",width:"180"}}),e._v(" "),r("el-table-column",{attrs:{prop:"contactWay",label:"联系方式",width:"180"}}),e._v(" "),r("el-table-column",{attrs:{label:"是否启用",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-switch",{on:{change:function(r){return e.isSupplierState(t.$index)}},model:{value:e.supplierData[t.$index].status,callback:function(r){e.$set(e.supplierData[t.$index],"status",r)},expression:"supplierData[scope.$index].status"}})]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"操作",align:"center","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{staticStyle:{margin:"0 4%"},attrs:{size:"mini"},on:{click:function(r){return e.openChange(t.$index)}}},[e._v("编辑")]),e._v(" "),r("el-button",{staticStyle:{margin:"0 4%"},attrs:{slot:"reference",size:"mini",type:"danger"},on:{click:function(r){return e.deleteReason(t.$index,e.supplierData)}},slot:"reference"},[e._v("删除")])]}}])})],1)],1),e._v(" "),r("el-dialog",{staticClass:"chang-supplier",attrs:{title:"编辑供应商信息","close-on-click-modal":!1,visible:e.dialogFormVisible,width:"420px",center:""},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[r("el-form",{ref:"changeFrom",staticClass:"info-form",attrs:{inline:"",rules:e.alterRules,model:e.alterForm}},[r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"供应商名称：",prop:"supplierName"}},[r("el-input",{attrs:{size:"small",placeholder:"供应商名称"},model:{value:e.alterForm.supplierName,callback:function(t){e.$set(e.alterForm,"supplierName",t)},expression:"alterForm.supplierName"}})],1),e._v(" "),r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"商品分类：",prop:"productType"}},[r("el-select",{attrs:{size:"small",filterable:"",placeholder:"请选择类别"},model:{value:e.alterForm.productType,callback:function(t){e.$set(e.alterForm,"productType",t)},expression:"alterForm.productType"}},e._l(e.productTypeInfo,function(e,t){return r("el-option",{key:t,attrs:{label:e,value:e}})}),1)],1),e._v(" "),r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"供应商负责人：",prop:"principal"}},[r("el-input",{attrs:{size:"small",placeholder:"供应商负责人"},model:{value:e.alterForm.principal,callback:function(t){e.$set(e.alterForm,"principal",t)},expression:"alterForm.principal"}})],1),e._v(" "),r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"联系方式：",prop:"contactWay"}},[r("el-input",{attrs:{size:"small",placeholder:"联系方式"},model:{value:e.alterForm.contactWay,callback:function(t){e.$set(e.alterForm,"contactWay",t)},expression:"alterForm.contactWay"}})],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{staticStyle:{padding:"12px 30px",margin:"0 30px"},attrs:{type:"primary"},on:{click:function(t){return e.submitChange("changeFrom")}}},[e._v("确 定")]),e._v(" "),r("el-button",{staticStyle:{padding:"12px 30px",margin:"0 30px"},on:{click:function(t){return e.cancelChange("changeFrom")}}},[e._v("取 消")])],1)],1)],1)},staticRenderFns:[]};var l=r("VU/8")(a,i,!1,function(e){r("WF7O")},null,null);t.default=l.exports}});
//# sourceMappingURL=27.7bca656fccce060482ac.js.map