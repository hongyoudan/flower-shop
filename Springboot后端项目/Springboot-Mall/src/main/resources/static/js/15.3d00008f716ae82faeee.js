webpackJsonp([15],{"5iBE":function(t,e){},UgUa:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"product-type"},[r("el-card",{staticClass:"product-hd",attrs:{shadow:"never"}},[r("div",{staticStyle:{"text-align":"left"},attrs:{slot:"header"},slot:"header"},[r("i",{staticClass:"el-icon-search"}),t._v(" "),r("span",[t._v("筛选搜索")]),t._v(" "),r("el-button",{staticClass:"el-button-search",staticStyle:{right:"111px"},attrs:{type:"primary"},on:{click:function(e){return t.queryProductType()}}},[t._v("查询")]),t._v(" "),r("el-button",{staticClass:"el-button-search",staticStyle:{right:"20px"},on:{click:function(e){return t.resetForm("productTypeForm")}}},[t._v("重置")])],1),t._v(" "),r("el-form",{ref:"productTypeForm",staticClass:"query-form",attrs:{model:t.productTypeForm,inline:""}},[r("el-form-item",{attrs:{label:"输入搜索：",prop:"key"}},[r("el-input",{attrs:{clearable:"",placeholder:"类别名称/关键字"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.queryProductType(e)}},model:{value:t.productTypeForm.key,callback:function(e){t.$set(t.productTypeForm,"key",e)},expression:"productTypeForm.key"}})],1)],1)],1),t._v(" "),r("el-card",{staticClass:"product-box",attrs:{shadow:"never"}},[r("div",{staticStyle:{"text-align":"left",position:"relative"},attrs:{slot:"header"},slot:"header"},[r("i",{staticClass:"el-icon-coin"}),t._v(" "),r("span",[t._v("数据列表")]),t._v(" "),r("el-button",{staticClass:"el-button-add",on:{click:t.addType}},[t._v("添加")])],1),t._v(" "),r("el-table",{staticClass:"type-table",staticStyle:{width:"100%"},attrs:{data:t.productType,height:"425",border:""}},[r("el-table-column",{attrs:{prop:"typeId",label:"编号",width:"100"}}),t._v(" "),r("el-table-column",{attrs:{prop:"typeName",label:"类别名称",width:"150"}}),t._v(" "),r("el-table-column",{attrs:{prop:"typeDescribe",label:"类别描述",width:"400"}}),t._v(" "),r("el-table-column",{attrs:{label:"横幅宣传图",align:"center",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.typeUrlTop?r("el-image",{staticStyle:{width:"275px",height:"100px"},attrs:{"preview-src-list":[e.row.typeUrlTop],src:e.row.typeUrlTop,fit:"fit"}}):t._e()]}}])}),t._v(" "),r("el-table-column",{attrs:{label:"左侧宣传图",align:"center",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.typeUrlLeft?r("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{"preview-src-list":[e.row.typeUrlLeft],src:e.row.typeUrlLeft,fit:"fit"}}):t._e()]}}])}),t._v(" "),r("el-table-column",{attrs:{label:"操作",align:"center","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-button",{attrs:{size:"mini"},on:{click:function(r){return t.openChange(e.$index)}}},[t._v("编辑")]),t._v(" "),r("el-button",{attrs:{slot:"reference",size:"mini",type:"danger"},on:{click:function(r){return t.deleteCheck(e.$index,t.productType)}},slot:"reference"},[t._v("删除")])]}}])})],1)],1),t._v(" "),r("el-dialog",{staticClass:"chang-product",attrs:{title:"编辑商品类别信息","close-on-click-modal":!1,visible:t.dialogFormVisible,center:""},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[r("el-form",{ref:"changeFrom",staticClass:"info-form",attrs:{inline:"",rules:t.alterRules,model:t.alterForm}},[r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"商品名称：",prop:"typeName"}},[r("el-input",{attrs:{size:"small",placeholder:"商品名称"},model:{value:t.alterForm.typeName,callback:function(e){t.$set(t.alterForm,"typeName",e)},expression:"alterForm.typeName"}})],1),t._v(" "),r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"商品描述：",prop:"typeDescribe"}},[r("el-input",{attrs:{size:"small",type:"textarea",autosize:"",placeholder:"商品描述"},model:{value:t.alterForm.typeDescribe,callback:function(e){t.$set(t.alterForm,"typeDescribe",e)},expression:"alterForm.typeDescribe"}})],1),t._v(" "),r("el-form-item",{staticStyle:{width:"45%",position:"absolute",top:"0",right:"20px"},attrs:{label:"横幅宣传图",prop:"typeUrlTop"}},[r("el-upload",{ref:"topUpload",staticClass:"product-upload",staticStyle:{display:"flex","justify-content":"center","align-items":"center",height:"100px",width:"217px"},attrs:{action:this.$VAR.http+"/uploadImage?name=productTypeImage","on-success":t.uploadTopSuccess,"before-upload":t.beforeAvatarUpload,drag:!0,"list-type":"picture"}},[t.alterForm.typeUrlTop?r("el-image",{staticStyle:{height:"100px",width:"217px"},attrs:{src:t.alterForm.typeUrlTop}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})],1)],1),t._v(" "),r("el-form-item",{staticStyle:{width:"45%",position:"absolute",top:"170px",right:"20px"},attrs:{label:"左侧宣传图",prop:"typeUrlLeft"}},[r("el-upload",{ref:"leftUpload",staticClass:"product-upload",staticStyle:{display:"flex","justify-content":"center","align-items":"center",height:"100px",width:"217px"},attrs:{action:this.$VAR.http+"/uploadImage?name=productTypeImage","on-success":t.uploadLeftSuccess,"before-upload":t.beforeAvatarUpload,drag:!0,"list-type":"picture"}},[t.alterForm.typeUrlLeft?r("el-image",{staticStyle:{height:"100px",width:"217px"},attrs:{src:t.alterForm.typeUrlLeft}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})],1)],1)],1),t._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{staticStyle:{padding:"12px 54px",margin:"0 55px"},attrs:{type:"primary"},on:{click:function(e){return t.submitChange("changeFrom")}}},[t._v("确 定")]),t._v(" "),r("el-button",{staticStyle:{padding:"12px 54px",margin:"0 55px"},on:{click:function(e){return t.cancelChange("changeFrom")}}},[t._v("取 消")])],1)],1)],1)},staticRenderFns:[]};var o=r("VU/8")({name:"ProductType",data:function(){return{productType:null,productTypeResource:null,handleIndex:0,dialogFormVisible:!1,insert:!1,productTypeForm:{key:""},alterForm:{typeId:"",typeName:"",typeDescribe:"",typeUrlTop:"",typeUrlLeft:""},alterRules:{typeName:[{required:!0,message:"请输入类别名称",trigger:"blur"},{min:1,max:30,message:"名称长度不允许超过 30 个字符",trigger:"blur"}],typeDescribe:[{required:!0,message:"请输入类别描述",trigger:"blur"},{min:1,max:100,message:"描述信息长度不允许超过 100 个字符",trigger:"blur"}],typeUrlTop:[{required:!0,message:"横幅宣传图",trigger:"blur"}],typeUrlLeft:[{required:!0,message:"左侧宣传图",trigger:"blur"}]}}},methods:{resetForm:function(t){this.$refs[t].resetFields()},queryProductType:function(){if(0!==this.productTypeForm.key.length){this.productType=[];for(var t=0,e=this.productTypeResource.length;t<e;t++)-1!==this.productTypeResource[t].typeName.indexOf(this.productTypeForm.key)&&this.productType.push(this.productTypeResource[t])}else this.productType=this.productTypeResource},beforeAvatarUpload:function(t){var e="image/jpeg"===t.type,r="image/gif"===t.type,a="image/png"===t.type,o="image/bmp"===t.type,s="image/webp"===t.type,i=t.size/1024/1024<5;return e||r||a||o||s?i||this.$msg.error("上传图片大小不能超过 5MB!"):this.$msg.error("仅支持上传 JPG、JPEG、PNG、GIF、BMP、WEBP 格式文件"),(e||r||a||o||s)&&i},openChange:function(t){this.handleIndex=t,this.insert=!1,this.alterForm.typeId=this.productType[t].typeId,this.alterForm.typeName=this.productType[t].typeName,this.alterForm.typeDescribe=this.productType[t].typeDescribe,this.alterForm.typeUrlTop=this.productType[t].typeUrlTop,this.alterForm.typeUrlLeft=this.productType[t].typeUrlLeft,this.dialogFormVisible=!0},deleteCheck:function(t,e){var r=this;this.$http.post("/product/existsType?productType="+this.productType[t].typeName).then(function(a){if(200===a.data.code){var o=r.productType[t].typeName;a.data.data?r.$alert("类别("+o+")\t存在商品，无法删除","警告",{confirmButtonText:"确定",type:"warning"}):r.$confirm("此操作将永久删除该类别信息, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a=r.$loading({lock:!0,text:"数据提交中",background:"rgba(255,255,255,0.1)"});r.$http.post("/productType/deleteById?typeId="+r.productType[t].typeId).then(function(s){a.close(),200===s.data.code?(e.splice(t,1),r.$notify({title:"成功",message:"类别("+o+")\t移除成功",type:"success"})):r.$notify({title:"错误",message:s.data.message,type:"error"})}).catch(function(t){a.close(),r.$msg.error(t)})}).catch(function(){r.$notify({title:"成功",message:"操作取消",type:"success"})})}}).catch(function(t){r.$msg.error(t)})},submitChange:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;e.insert?e.$http.post("/productType/existsTypeName?typeId=0&typeName="+e.alterForm.typeName).then(function(t){if(200===t.data.code)if(t.data.data)e.$alert("类别("+e.alterForm.typeName+")\t已存在，不能重复添加","警告",{confirmButtonText:"确定",type:"warning"});else{var r=e.$loading({lock:!0,text:"数据提交中",background:"rgba(255,255,255,0.1)"});e.$http.post("/productType/add",e.$qs.stringify(e.alterForm)).then(function(t){r.close(),200===t.data.code?(e.dialogFormVisible=!1,e.reqInfo(),e.$notify({title:"成功",message:e.alterForm.typeName+"\t类别添加成功",type:"success"})):e.$notify({title:"错误",message:t.data.message,type:"error"})}).catch(function(t){r.close(),e.$msg.error(t)})}}).catch(function(t){e.$msg.error(t)}):e.$http.post("/productType/existsTypeName?typeId="+e.alterForm.typeId+"&typeName="+e.alterForm.typeName).then(function(t){if(200===t.data.code)if(t.data.data)e.$alert("类别("+e.alterForm.typeName+")\t已存在，无法完成修改操作","警告",{confirmButtonText:"确定",type:"warning"});else{var r=e.$loading({lock:!0,text:"数据提交中",background:"rgba(255,255,255,0.1)"});e.$http.post("/productType/update",e.$qs.stringify(e.alterForm)).then(function(t){r.close(),200===t.data.code?(e.dialogFormVisible=!1,e.productType[e.handleIndex]=e.alterForm,e.$notify({title:"成功",message:"类别信息更新成功",type:"success"})):e.$notify({title:"错误",message:t.data.message,type:"error"})}).catch(function(t){r.close(),e.$msg.error(t)})}}).catch(function(t){e.$msg.error(t)})})},cancelChange:function(t){this.dialogFormVisible=!1,this.$refs[t].resetFields(),this.$notify({title:"操作取消",message:"",type:"success"})},uploadTopSuccess:function(t){200===t.code?(this.$msg.success("横幅宣传图上传成功！"),this.alterForm.typeUrlTop=t.data,this.$refs.topUpload.clearFiles()):this.$msg.error("横幅宣传图上传失败！")},uploadLeftSuccess:function(t){200===t.code?(this.$msg.success("左侧宣传图上传成功！"),this.alterForm.typeUrlLeft=t.data,this.$refs.leftUpload.clearFiles()):this.$msg.error("左侧宣传图上传失败！")},addType:function(){delete this.alterForm.typeId,this.alterForm.typeName="",this.alterForm.typeDescribe="",this.alterForm.typeUrlTop="",this.alterForm.typeUrlLeft="",this.insert=!0,this.dialogFormVisible=!0},reqInfo:function(){var t=this;this.$http.post("/productType/findAll").then(function(e){200===e.data.code&&(t.productTypeResource=t.productType=e.data.data)}).catch(function(e){t.$msg.error(e)})}},created:function(){this.reqInfo()}},a,!1,function(t){r("5iBE")},null,null);e.default=o.exports}});
//# sourceMappingURL=15.3d00008f716ae82faeee.js.map