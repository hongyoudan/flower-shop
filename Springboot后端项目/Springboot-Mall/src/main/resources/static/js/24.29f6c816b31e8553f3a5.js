webpackJsonp([24],{Dn2r:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"purchase"},[r("el-card",{staticClass:"purchase-hd",attrs:{shadow:"never"}},[r("div",{staticStyle:{"text-align":"left"},attrs:{slot:"header"},slot:"header"},[r("i",{staticClass:"el-icon-search"}),e._v(" "),r("span",[e._v("筛选搜索")]),e._v(" "),r("el-button",{staticClass:"el-button-search",staticStyle:{right:"111px"},attrs:{type:"primary"},on:{click:function(t){return e.queryPurchase()}}},[e._v("查询")]),e._v(" "),r("el-button",{staticClass:"el-button-search",staticStyle:{right:"20px"},on:{click:function(t){return e.resetForm("queryForm")}}},[e._v("重置")])],1),e._v(" "),r("el-form",{ref:"queryForm",staticClass:"query-form",attrs:{model:e.queryForm,inline:""}},[r("el-form-item",{attrs:{label:"采购编号：",prop:"purchaseNo"}},[r("el-input",{attrs:{placeholder:"采购编号"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.queryPurchase(t)}},model:{value:e.queryForm.purchaseNo,callback:function(t){e.$set(e.queryForm,"purchaseNo",t)},expression:"queryForm.purchaseNo"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"商品编号：",prop:"productNo"}},[r("el-input",{attrs:{placeholder:"商品编号"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.queryPurchase(t)}},model:{value:e.queryForm.productNo,callback:function(t){e.$set(e.queryForm,"productNo",t)},expression:"queryForm.productNo"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"操作员：",prop:"user"}},[r("el-input",{attrs:{placeholder:"帐号/姓名"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.queryPurchase(t)}},model:{value:e.queryForm.user,callback:function(t){e.$set(e.queryForm,"user",t)},expression:"queryForm.user"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"采购状态：",prop:"status"}},[r("el-select",{attrs:{filterable:"",placeholder:"全部",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.queryPurchase(t)}},model:{value:e.queryForm.status,callback:function(t){e.$set(e.queryForm,"status",t)},expression:"queryForm.status"}},e._l(e.purchaseStates,function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1)],1)],1),e._v(" "),r("el-card",{staticClass:"purchase-box",attrs:{shadow:"never"}},[r("div",{staticStyle:{"text-align":"left",position:"relative"},attrs:{slot:"header"},slot:"header"},[r("i",{staticClass:"el-icon-coin"}),e._v(" "),r("span",[e._v("数据列表")])]),e._v(" "),r("el-table",{staticClass:"type-table",staticStyle:{width:"100%","user-select":"text"},attrs:{data:e.purchaseData,height:"425",border:""}},[r("el-table-column",{attrs:{prop:"purchaseId",label:"编号",width:"80"}}),e._v(" "),r("el-table-column",{attrs:{prop:"purchaseNo",label:"采购信息编号",width:"150"}}),e._v(" "),r("el-table-column",{attrs:{prop:"purchaseTime",label:"采购时间",width:"180"}}),e._v(" "),r("el-table-column",{attrs:{label:"商品编号",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.purchaseData?r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right",content:"商品名称："+e.purchaseData[t.$index].productName}},[r("p",{staticStyle:{cursor:"pointer"},domProps:{textContent:e._s(e.purchaseData[t.$index].productNo)}})]):e._e()]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"purchaseNumber",label:"采购数量",width:"90"}}),e._v(" "),r("el-table-column",{attrs:{label:"供应商编号",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.purchaseData?r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right",content:"供应商："+e.purchaseData[t.$index].supplierName}},[r("p",{staticStyle:{cursor:"pointer"},domProps:{textContent:e._s(e.purchaseData[t.$index].supplierNo)}})]):e._e()]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"操作员帐号",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.purchaseData?r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right",content:"操作员："+e.purchaseData[t.$index].userName}},[r("p",{staticStyle:{cursor:"pointer"},domProps:{textContent:e._s(e.purchaseData[t.$index].accountNumber)}})]):e._e()]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"receiptTime",label:"收货时间",width:"180"}}),e._v(" "),r("el-table-column",{attrs:{label:"采购状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.purchaseData[t.$index].receiptStatus?r("span",[e._v("已收货")]):r("span",[e._v("未收货")])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"操作",align:"center","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.purchaseData[t.$index].receiptStatus?r("el-button",{attrs:{size:"mini"},on:{click:function(r){return e.lookOver(t.$index)}}},[e._v("查看详情")]):r("el-button",{attrs:{slot:"reference",size:"mini",type:"danger"},on:{click:function(r){return e.receipts(t.$index)}},slot:"reference"},[e._v("确认收货")])]}}])})],1)],1),e._v(" "),r("el-dialog",{staticClass:"chang-purchase",attrs:{title:"采购信息","close-on-click-modal":!1,visible:e.dialogFormVisible,width:"800px",center:""},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[r("el-form",{ref:"changeFrom",staticClass:"info-form",attrs:{inline:"",model:e.alterForm}},[r("el-form-item",{attrs:{label:"采购编号：",prop:"purchaseNo"}},[r("el-input",{attrs:{size:"small",readonly:"",placeholder:"采购编号"},model:{value:e.alterForm.purchaseNo,callback:function(t){e.$set(e.alterForm,"purchaseNo",t)},expression:"alterForm.purchaseNo"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"采购数量：",prop:"purchaseNumber"}},[r("el-input",{attrs:{size:"small",readonly:"",placeholder:"采购数量"},model:{value:e.alterForm.purchaseNumber,callback:function(t){e.$set(e.alterForm,"purchaseNumber",t)},expression:"alterForm.purchaseNumber"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"商品编号：",prop:"productNo"}},[r("el-input",{attrs:{size:"small",readonly:"",placeholder:"商品编号"},model:{value:e.alterForm.productNo,callback:function(t){e.$set(e.alterForm,"productNo",t)},expression:"alterForm.productNo"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"商品名称：",prop:"productName"}},[r("el-input",{attrs:{size:"small",readonly:"",placeholder:"商品名称"},model:{value:e.alterForm.productName,callback:function(t){e.$set(e.alterForm,"productName",t)},expression:"alterForm.productName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"供应商编号：",prop:"supplierNo"}},[r("el-input",{attrs:{size:"small",readonly:"",placeholder:"供应商编号"},model:{value:e.alterForm.supplierNo,callback:function(t){e.$set(e.alterForm,"supplierNo",t)},expression:"alterForm.supplierNo"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"供应商名称：",prop:"supplierName"}},[r("el-input",{attrs:{size:"small",readonly:"",placeholder:"供应商名称"},model:{value:e.alterForm.supplierName,callback:function(t){e.$set(e.alterForm,"supplierName",t)},expression:"alterForm.supplierName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"操作员帐号：",prop:"accountNumber"}},[r("el-input",{attrs:{size:"small",readonly:"",placeholder:"操作员帐号"},model:{value:e.alterForm.accountNumber,callback:function(t){e.$set(e.alterForm,"accountNumber",t)},expression:"alterForm.accountNumber"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"操作员名称：",prop:"userName"}},[r("el-input",{attrs:{size:"small",readonly:"",placeholder:"操作员名称"},model:{value:e.alterForm.userName,callback:function(t){e.$set(e.alterForm,"userName",t)},expression:"alterForm.userName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"收货时间：",prop:"receiptTime"}},[r("el-input",{attrs:{size:"small",readonly:"",placeholder:"收货时间"},model:{value:e.alterForm.receiptTime,callback:function(t){e.$set(e.alterForm,"receiptTime",t)},expression:"alterForm.receiptTime"}})],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{staticStyle:{padding:"12px 80px"},attrs:{type:"primary"},on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var s=r("VU/8")({name:"Purchase",data:function(){return{purchaseData:null,purchaseResource:null,handleIndex:0,dialogFormVisible:!1,purchaseStates:["未收货","已收货"],queryForm:{purchaseNo:"",productNo:"",user:"",status:""},alterForm:{purchaseNo:"",productNo:"",productName:"",purchaseNumber:"",receiptTime:"",supplierNo:"",supplierName:"",accountNumber:"",userName:""}}},methods:{resetForm:function(e){this.$refs[e].resetFields()},receipts:function(e){var t=this,r=this.purchaseData[e].purchaseNumber,a=this.purchaseData[e].productNo,s=this.purchaseData[e].purchaseId;this.$confirm("请核对商品名称及商品数量是否正确","提示",{confirmButtonText:"收货",cancelButtonText:"取消",type:"warning"}).then(function(){var l=t.$loading({lock:!0,text:"数据提交中",background:"rgba(255,255,255,0.1)"});t.$http.post("/purchase/receipts?productNo="+a+"&purchaseId="+s+"&purchaseNumber="+r).then(function(r){l.close(),200===r.data.code?(t.reqInfo(),t.$notify({title:"成功",message:t.purchaseData[e].productName+"\t"+r.data.message,type:"success"})):t.$notify.error({title:"失败",message:r.data.message})}).catch(function(e){l.close(),t.$msg.error(e)})}).catch(function(){})},lookOver:function(e){this.alterForm=this.purchaseData[e],this.dialogFormVisible=!0},queryPurchase:function(){var e=this.queryForm;if(0===e.purchaseNo.length&&0===e.productNo.length&&0===e.user.length&&0===e.status.length)this.purchaseData=this.purchaseResource;else{this.purchaseData=[];for(var t=0,r=this.purchaseResource.length;t<r;t++)0!==e.purchaseNo.length&&-1!==this.purchaseResource[t].purchaseNo.indexOf(e.purchaseNo)&&this.purchaseData.push(this.purchaseResource[t]),0!==e.productNo.length&&-1!==this.purchaseResource[t].productNo.indexOf(e.productNo)&&this.purchaseData.push(this.purchaseResource[t]),0!==e.user.length&&(-1!==this.purchaseResource[t].userName.indexOf(e.user)?this.purchaseData.push(this.purchaseResource[t]):-1!==this.purchaseResource[t].accountNumber.indexOf(e.user)&&this.purchaseData.push(this.purchaseResource[t])),0!==e.status.length&&(-1!==e.status.indexOf("已收货")&&this.purchaseResource[t].receiptStatus?this.purchaseData.push(this.purchaseResource[t]):-1===e.status.indexOf("未收货")||this.purchaseResource[t].receiptStatus||this.purchaseData.push(this.purchaseResource[t]))}},isSupplierState:function(e){var t=this;this.$http.post("/purchase/updateSupplier?purchaseId="+this.purchaseData[e].purchaseId+"&receiptStatus="+this.purchaseData[e].receiptStatus).then(function(r){200===r.data.code&&(t.purchaseData[e].receiptStatus?t.$notify({title:"成功",message:"供应商（"+t.purchaseData[e].purchaseName+"）\t已启用",type:"success"}):t.$notify({title:"成功",message:"供应商（"+t.purchaseData[e].purchaseName+"）\t已禁用",type:"success"}))}).catch(function(e){t.$msg.error(e)})},reqInfo:function(){var e=this;this.$http.post("/purchase/findPurchaseAll").then(function(t){200===t.data.code&&(e.purchaseResource=e.purchaseData=t.data.data)}).catch(function(t){e.$msg.error(t)})}},created:function(){this.reqInfo()}},a,!1,function(e){r("wRSm")},null,null);t.default=s.exports},wRSm:function(e,t){}});
//# sourceMappingURL=24.29f6c816b31e8553f3a5.js.map