webpackJsonp([13],{"6tac":function(e,t){},p95f:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"return-goods"},[r("el-card",{staticClass:"box-card return-goods-card",attrs:{shadow:"never"}},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("i",{staticClass:"el-icon-search"}),e._v(" "),r("span",[e._v("筛选搜索")]),e._v(" "),r("el-button",{staticClass:"el-button-search",attrs:{type:"primary"},on:{click:function(t){return e.queryOrder(e.returnGoodsSource)}}},[e._v("查询")]),e._v(" "),r("el-button",{staticClass:"el-button-search",on:{click:function(t){return e.resetForm("queryForm")}}},[e._v("重置")])],1),e._v(" "),r("el-form",{ref:"queryForm",staticClass:"el-form",attrs:{model:e.queryForm,inline:""}},[r("el-form-item",{attrs:{label:"订单编号：",prop:"orderNo"}},[r("el-input",{attrs:{placeholder:"订单编号"},model:{value:e.queryForm.orderNo,callback:function(t){e.$set(e.queryForm,"orderNo",t)},expression:"queryForm.orderNo"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"申请人：",prop:"user"}},[r("el-input",{attrs:{placeholder:"申请人帐号/姓名","auto-complete":"no"},model:{value:e.queryForm.user,callback:function(t){e.$set(e.queryForm,"user",t)},expression:"queryForm.user"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"操作员：",prop:"operator"}},[r("el-input",{attrs:{placeholder:"操作员帐号/姓名","auto-complete":"no"},model:{value:e.queryForm.operator,callback:function(t){e.$set(e.queryForm,"operator",t)},expression:"queryForm.operator"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"退货状态：",prop:"returnState"}},[r("el-select",{attrs:{filterable:"",placeholder:"全部",clearable:""},model:{value:e.queryForm.returnState,callback:function(t){e.$set(e.queryForm,"returnState",t)},expression:"queryForm.returnState"}},e._l(e.returnStates,function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"退货原因：",prop:"returnReason"}},[r("el-select",{attrs:{placeholder:"全部",clearable:""},model:{value:e.queryForm.returnReason,callback:function(t){e.$set(e.queryForm,"returnReason",t)},expression:"queryForm.returnReason"}},e._l(e.returnReasonInfo,function(e,t){return r("el-option",{key:t,attrs:{label:e,value:e}})}),1)],1)],1)],1),e._v(" "),r("el-card",{staticClass:"box-card return-goods-card",attrs:{shadow:"never"}},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("i",{staticClass:"el-icon-coin"}),e._v(" "),r("span",[e._v("数据列表")])]),e._v(" "),r("div",[r("el-table",{staticStyle:{width:"100%"},attrs:{slot:"empty",data:e.tableData,height:"500px",border:"",stripe:"","highlight-current-row":""},slot:"empty"},[r("el-table-column",{attrs:{prop:"returnId",label:"编号",align:"center",width:"50"}}),e._v(" "),r("el-table-column",{attrs:{prop:"applyTime",label:"申请时间",align:"center",width:"180"}}),e._v(" "),r("el-table-column",{attrs:{label:"用户帐号",align:"center",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.tableData?r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right",content:"姓名："+e.tableData[t.$index].userName}},[r("p",{staticStyle:{cursor:"pointer"},domProps:{textContent:e._s(e.tableData[t.$index].userNumber)}})]):e._e()]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"orderNo",label:"订单编号",align:"center",width:"140"}}),e._v(" "),r("el-table-column",{attrs:{prop:"returnPrice",label:"退款金额",align:"center",width:"100"}}),e._v(" "),r("el-table-column",{attrs:{prop:"returnReason",label:"退货原因",align:"center",width:"140"}}),e._v(" "),r("el-table-column",{attrs:{label:"操作员",align:"center",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.tableData?r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right",content:"姓名："+e.tableData[t.$index].operatorName}},[r("p",{staticStyle:{cursor:"pointer"},domProps:{textContent:e._s(e.tableData[t.$index].operatorNumber)}})]):e._e()]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"申请状态",align:"center",width:"90"},scopedSlots:e._u([{key:"default",fn:function(t){return["待处理"===t.row.returnState||"待退款"===t.row.returnState?r("span",{staticStyle:{color:"#ff0000"}},[e._v(e._s(t.row.returnState))]):r("span",[e._v(e._s(t.row.returnState))])]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"dealTime",label:"处理时间",align:"center",width:"180"}}),e._v(" "),r("el-table-column",{attrs:{label:"操作",align:"center","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return["待收货"===t.row.returnState?r("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(r){return e.receiveGoods(t.$index)}}},[e._v("确认收货")]):e._e(),e._v(" "),"待处理"===t.row.returnState?r("el-button",{attrs:{size:"mini"},on:{click:function(r){return e.agree(t.$index)}}},[e._v("同意")]):e._e(),e._v(" "),"待处理"===t.row.returnState?r("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(r){return e.reject(t.$index)}}},[e._v("拒绝")]):e._e(),e._v(" "),"待退款"===t.row.returnState?r("el-button",{attrs:{size:"mini"},on:{click:function(r){return e.refund(t.$index)}}},[e._v("退款")]):e._e(),e._v(" "),"待退款"===t.row.returnState?r("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(r){return e.rejectRefund(t.$index)}}},[e._v("拒绝")]):"待收货"!==t.row.returnState&&"待处理"!==t.row.returnState?r("el-button",{attrs:{size:"mini"},on:{click:function(r){return e.orderInfo(t.$index)}}},[e._v("订单详情")]):e._e()]}}])})],1),e._v(" "),r("div",{staticClass:"block"},[r("el-pagination",{attrs:{"page-sizes":e.pageSizes,"page-size":e.pageSize,"current-page":e.pageIndex,layout:"total, sizes, prev, pager, next, jumper",total:e.returnGoodsTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)])],1)},staticRenderFns:[]};var o=r("VU/8")({name:"ReturnGoods",data:function(){return{dialogFormVisible:!1,handleIndex:0,returnGoodsTotal:0,pageIndex:1,pageSize:10,pageSizes:[3,5,10,15,20],tableData:[],returnGoodsSource:{},returnGoodsTemp:{},returnReasonInfo:[],queryForm:{orderNo:"",user:"",operator:"",returnState:"",returnReason:""},returnStates:["待处理","待收货","已拒绝","退款完成","拒绝退款","允许退货","退货完成"]}},created:function(){var e=this;this.$http.post("/returnReason/findReasonName").then(function(t){200===t.data.code?e.returnReasonInfo=t.data.data:e.$msg.error(t.data.message)}).catch(function(t){e.$msg.error(t)}),this.reqInfo()},methods:{cancelChange:function(e){this.$refs[e].resetFields(),this.dialogFormVisible=!1},orderInfo:function(e){var t=this.tableData[e].orderNo;this.$router.push({path:"/OrderDetail",query:{orderNo:t,state:"1"}})},agree:function(e){var t=this;this.$confirm("同意买家的退货申请？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var r=t.$store.state.user.accountNumber,n=t.$store.state.user.userName,o=t.$loading({lock:!0,text:"数据提交中",background:"rgba(255,255,255,0.1)"});t.$http.post("/returnGoods/dealWithReturn?returnId="+t.tableData[e].returnId+"&operatorNumber="+r+"&operatorName="+n).then(function(r){o.close(),200===r.data.code&&(t.reqInfo(),t.$notify({title:"成功",message:t.tableData[e].userName+"\t退货申请已处理",type:"success"}))}).catch(function(e){o.close(),t.$msg.error(e)})}).catch(function(){})},refund:function(e){var t=this,r=this.tableData[e].orderNo,n=this.tableData[e].returnPrice,o=["请核查订单编号："+r+"，退款金额："+n+"元","同意买家的退款申请？"],a=[],s=this.$createElement,u=0;for(u in o)o.hasOwnProperty(u)&&a.push(s("p",null,o[u]));this.$confirm("提示",{title:"提示",message:s("div",null,a),showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var o=t.$loading({lock:!0,text:"订单提交中",background:"rgba(255,255,255,0.1)"});t.$http.get("/alipay/refund?orderNo="+r+"&payPrice="+n).then(function(r){if(o.close(),200===r.data.code){var a=t.$store.state.user.accountNumber,s=t.$store.state.user.userName,u=t.$loading({lock:!0,text:"数据处理中",background:"rgba(255,255,255,0.1)"});t.$http.post("/returnGoods/dealRefund?returnId="+t.tableData[e].returnId+"&operatorNumber="+a+"&operatorName="+s).then(function(e){u.close(),200===e.data.code&&(t.reqInfo(),t.$notify({title:"成功",message:"商品退款成功，退款金额："+n+"￥",type:"success"}))}).catch(function(e){u.close(),t.$msg.error(e)})}}).catch(function(e){o.close(),t.$msg.error(e)})}).catch(function(){})},receiveGoods:function(e){var t=this;this.$confirm("请收到商品并检查无误后，再确认收货","提示",{confirmButtonText:"已收到货",cancelButtonText:"未收到货",type:"success"}).then(function(){var r=t.$loading({lock:!0,text:"数据提交中",background:"rgba(255,255,255,0.2)"}),n=t.tableData[e].returnId;t.$http.post("/returnGoods/receipt?returnId="+n).then(function(n){if(r.close(),200===n.data.code){t.reqInfo(),t.$notify({title:"成功",message:"收货成功",type:"success"});var o=t.tableData[e].orderNo,a=t.tableData[e].returnPrice,s="请核查订单编号："+o+",退款金额："+a;t.$alert(s,"自动退款",{confirmButtonText:"确定",type:"success",callback:function(){t.$http.get("/alipay/refund?orderNo="+o+"&payPrice="+a).then(function(e){200===e.data.code&&t.$notify({title:"成功",message:"商品退款成功，退款金额："+a+"￥",type:"success"})}).catch(function(e){r.close(),t.$msg.error(e)})}})}}).catch(function(e){t.$msg.error(e)})}).catch(function(){})},reject:function(e){var t=this;this.$confirm("拒绝买家的退货申请？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var r=t.$store.state.user.accountNumber,n=t.$store.state.user.userName,o=t.$loading({lock:!0,text:"数据提交中",background:"rgba(255,255,255,0.1)"});t.$http.post("/returnGoods/refuseReturn?returnId="+t.tableData[e].returnId+"&operatorNumber="+r+"&operatorName="+n).then(function(r){o.close(),200===r.data.code&&(t.reqInfo(),t.$notify({title:"成功",message:t.tableData[e].userName+"\t退货申请已拒绝",type:"success"}))}).catch(function(e){o.close(),t.$msg.error(e)})}).catch(function(){})},rejectRefund:function(e){var t=this;this.$confirm("拒绝买家的退款申请？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var r=t.$store.state.user.accountNumber,n=t.$store.state.user.userName,o=t.$loading({lock:!0,text:"数据提交中",background:"rgba(255,255,255,0.1)"});t.$http.post("/returnGoods/rejectRefund?returnId="+t.tableData[e].returnId+"&operatorNumber="+r+"&operatorName="+n).then(function(r){o.close(),200===r.data.code&&(t.reqInfo(),t.$notify({title:"成功",message:t.tableData[e].userName+"\t退款申请已拒绝",type:"success"}))}).catch(function(e){o.close(),t.$msg.error(e)})}).catch(function(){})},resetForm:function(e){this.$refs[e].resetFields()},queryOrder:function(e){this.returnGoods=[];var t=this.queryForm,r=0;if(0===t.orderNo.length&&0===t.user.length&&0===t.operator.length&&0===t.returnState.length&&0===t.returnReason.length)this.returnGoods=this.returnGoodsSource,this.returnGoodsTotal=this.returnGoodsSource.length;else{for(var n=0;n<e.length;n++)0!==t.orderNo.length&&e[n].orderNo===t.orderNo&&(this.returnGoods.push(e[n]),r++),0!==t.user.length&&(-1!==e[n].userName.indexOf(t.user)?(this.returnGoods.push(e[n]),r++):-1!==e[n].userNumber.indexOf(t.user)&&(this.returnGoods.push(e[n]),r++)),0!==t.operator.length&&(-1!==e[n].operatorName.indexOf(t.operator)?(this.returnGoods.push(e[n]),r++):-1!==e[n].operatorNumber.indexOf(t.operator)&&(this.returnGoods.push(e[n]),r++)),0!==t.returnState.length&&-1!==e[n].returnState.indexOf(t.returnState)&&(this.returnGoods.push(e[n]),r++),0!==t.returnReason.length&&-1!==e[n].returnReason.indexOf(t.returnReason)&&(this.returnGoods.push(e[n]),r++);this.returnGoodsTotal=r}this.handleSizeChange(this.pageSize)},handleSizeChange:function(e){this.pageSize=e,this.handleCurrentChange(this.pageIndex)},handleCurrentChange:function(e){this.pageIndex=e,this.currentChangePage(this.returnGoods,e)},currentChangePage:function(e,t){var r=(t-1)*this.pageSize,n=t*this.pageSize;for(n>this.returnGoodsTotal&&(n=this.returnGoodsTotal),this.tableData=[];r<n;r++)this.tableData.push(e[r])},reqInfo:function(){var e=this,t=this.$loading({lock:!0,text:"数据加载中",spinner:"el-icon-loading",background:"rgba(255,255,255,0.1)"});this.$http.post("/returnGoods/findCount").then(function(r){t.close(),200===r.data.code?(e.returnGoodsTotal=r.data.data,e.pageSizes.push(e.returnGoodsTotal),e.$http.post("/returnGoods/findAllReturn").then(function(t){200===t.data.code?(e.tableData=t.data.data,e.returnGoodsSource=e.returnGoods=e.tableData,e.handleSizeChange(e.pageSize)):e.$msg.error(t.data.message)}).catch(function(r){t.close(),e.$msg.error(r)})):e.$msg.error(r.data.message)}).catch(function(t){e.$msg.error(t)})}}},n,!1,function(e){r("6tac")},null,null);t.default=o.exports}});
//# sourceMappingURL=13.55834183457e044e3912.js.map