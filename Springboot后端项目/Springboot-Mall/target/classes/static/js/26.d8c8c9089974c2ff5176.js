webpackJsonp([26],{Lmsw:function(e,t){},vDop:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"slide-show"},[r("el-card",{staticClass:"slideshow-hd",attrs:{shadow:"never"}},[r("div",{staticStyle:{"text-align":"left"},attrs:{slot:"header"},slot:"header"},[r("i",{staticClass:"el-icon-search"}),e._v(" "),r("span",[e._v("筛选搜索")]),e._v(" "),r("el-button",{staticClass:"el-button-search",staticStyle:{right:"111px"},attrs:{type:"primary"},on:{click:function(t){return e.queryProductName()}}},[e._v("查询")]),e._v(" "),r("el-button",{staticClass:"el-button-search",staticStyle:{right:"20px"},on:{click:function(t){return e.resetForm("productNameForm")}}},[e._v("重置")])],1),e._v(" "),r("el-form",{ref:"productNameForm",staticClass:"query-form",attrs:{model:e.productNameForm,inline:""}},[r("el-form-item",{attrs:{label:"输入搜索：",prop:"key"}},[r("el-input",{attrs:{clearable:"",placeholder:"商品名称"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.queryProductName(t)}},model:{value:e.productNameForm.key,callback:function(t){e.$set(e.productNameForm,"key",t)},expression:"productNameForm.key"}})],1)],1)],1),e._v(" "),r("el-card",{staticClass:"slideshow-box",attrs:{shadow:"never"}},[r("div",{staticStyle:{"text-align":"left",position:"relative"},attrs:{slot:"header"},slot:"header"},[r("i",{staticClass:"el-icon-coin"}),e._v(" "),r("span",[e._v("数据列表")]),e._v(" "),r("el-button",{staticClass:"el-button-add",on:{click:e.addBanner}},[e._v("添加")])],1),e._v(" "),r("el-table",{staticClass:"type-table",staticStyle:{width:"100%"},attrs:{data:e.slideShow,height:"425",border:""}},[r("el-table-column",{attrs:{prop:"bannerId",label:"编号",width:"100"}}),e._v(" "),r("el-table-column",{attrs:{prop:"productName",label:"商品名称",width:"300"}}),e._v(" "),r("el-table-column",{attrs:{label:"轮播图",align:"center",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.bannerUrl?r("el-image",{staticStyle:{width:"275px",height:"100px"},attrs:{"preview-src-list":[t.row.bannerUrl],src:t.row.bannerUrl,fit:"fit"}}):e._e()]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"商品链接",align:"center",width:"400"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.productUrl?r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"bottom",content:t.row.productUrl}},[r("el-link",{attrs:{type:"warning",href:t.row.productUrl}},[r("i",{staticClass:"el-icon-view el-icon--right"}),e._v(" 查看商品")])],1):e._e()]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"操作",align:"center","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini"},on:{click:function(r){return e.openChange(t.$index)}}},[e._v("编辑")]),e._v(" "),r("el-button",{attrs:{slot:"reference",size:"mini",type:"danger"},on:{click:function(r){return e.deleteBanner(t.$index,e.slideShow)}},slot:"reference"},[e._v("删除")])]}}])})],1)],1),e._v(" "),r("el-dialog",{staticClass:"chang-product",attrs:{title:"编辑商品轮播图信息","close-on-click-modal":!1,visible:e.dialogFormVisible,center:""},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[r("el-form",{ref:"changeFrom",staticClass:"info-form",attrs:{inline:"",rules:e.alterRules,model:e.alterForm}},[r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"商品名称：",prop:"productName"}},[r("el-input",{attrs:{size:"small",placeholder:"商品名称"},model:{value:e.alterForm.productName,callback:function(t){e.$set(e.alterForm,"productName",t)},expression:"alterForm.productName"}})],1),e._v(" "),r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"商品链接：",prop:"productUrl"}},[r("el-input",{attrs:{size:"small",autosize:"",placeholder:"商品购买页链接"},model:{value:e.alterForm.productUrl,callback:function(t){e.$set(e.alterForm,"productUrl",t)},expression:"alterForm.productUrl"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"商品宣传图",prop:"bannerUrl"}},[r("el-upload",{ref:"bannerUpload",staticClass:"product-upload",staticStyle:{display:"flex","justify-content":"center","align-items":"center",height:"100px",width:"217px"},attrs:{action:this.$VAR.http+"/uploadImage?name=bannerImage","on-success":e.uploadSuccess,"before-upload":e.beforeAvatarUpload,drag:!0,"list-type":"picture"}},[e.alterForm.bannerUrl?r("el-image",{staticStyle:{height:"100px",width:"217px"},attrs:{src:e.alterForm.bannerUrl}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})],1)],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{staticStyle:{padding:"12px 43px",margin:"0 30px"},attrs:{type:"primary"},on:{click:function(t){return e.submitChange("changeFrom")}}},[e._v("确 定")]),e._v(" "),r("el-button",{staticStyle:{padding:"12px 43px",margin:"0 30px"},on:{click:function(t){return e.cancelChange("changeFrom")}}},[e._v("取 消")])],1)],1)],1)},staticRenderFns:[]};var s=r("VU/8")({name:"SlideShow",data:function(){return{slideShow:null,slideShowResource:null,handleIndex:0,dialogFormVisible:!1,insert:!1,productNameForm:{key:""},alterForm:{bannerId:"",productName:"",productUrl:"",bannerUrl:""},alterRules:{productName:[{required:!0,message:"请输入商品名称",trigger:"blur"},{min:1,max:30,message:"名称长度不允许超过 30 个字符",trigger:"blur"}],productUrl:[{required:!0,message:"请输入商品购买页面链接",trigger:"blur"},{min:1,max:100,message:"商品链接长度不允许超过 200 个字符",trigger:"blur"}],bannerUrl:[{required:!0,message:"请上传宣传图",trigger:"blur"}]}}},methods:{resetForm:function(e){this.$refs[e].resetFields()},queryProductName:function(){if(0!==this.productNameForm.key.length){this.slideShow=[];for(var e=0,t=this.slideShowResource.length;e<t;e++)-1!==this.slideShowResource[e].productName.indexOf(this.productNameForm.key)&&this.slideShow.push(this.slideShowResource[e])}else this.slideShow=this.slideShowResource},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type,r="image/gif"===e.type,a="image/png"===e.type,s="image/bmp"===e.type,l="image/webp"===e.type,o=e.size/1024/1024<5;return t||r||a||s||l?o||this.$msg.error("上传图片大小不能超过 5MB!"):this.$msg.error("仅支持上传 JPG、JPEG、PNG、GIF、BMP、WEBP 格式文件"),(t||r||a||s||l)&&o},openChange:function(e){this.handleIndex=e,this.insert=!1,this.alterForm=this.slideShow[e],this.dialogFormVisible=!0},deleteBanner:function(e,t){var r=this,a=this.slideShow[e].productName;this.$confirm("此操作将永久删除该宣传图信息, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var s=r.$loading({lock:!0,text:"数据提交中",background:"rgba(255,255,255,0.1)"});r.$http.post("/banner/deleteById?bannerId="+r.slideShow[e].bannerId).then(function(l){s.close(),200===l.data.code?(t.splice(e,1),r.$notify({title:"成功",message:"宣传图("+a+")\t移除成功",type:"success"})):r.$notify({title:"错误",message:l.data.message,type:"error"})}).catch(function(e){s.close(),r.$msg.error(e)})}).catch(function(){r.$notify({title:"成功",message:"操作取消",type:"success"})})},submitChange:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;if(t.insert){t.alterForm.bannerId=null;var r=t.$loading({lock:!0,text:"数据提交中",background:"rgba(255,255,255,0.1)"});t.$http.post("/banner/add",t.$qs.stringify(t.alterForm,{skipNulls:!0})).then(function(e){r.close(),200===e.data.code?(t.dialogFormVisible=!1,t.reqInfo(),t.$notify({title:"成功",message:t.alterForm.productName+"\t宣传图添加成功",type:"success"})):t.$notify({title:"错误",message:e.data.message,type:"error"})}).catch(function(e){r.close(),t.$msg.error(e)})}else{var a=t.$loading({lock:!0,text:"数据提交中",background:"rgba(255,255,255,0.1)"});t.$http.post("/banner/update",t.$qs.stringify(t.alterForm)).then(function(e){a.close(),200===e.data.code?(t.dialogFormVisible=!1,t.slideShow[t.handleIndex]=t.alterForm,t.$notify({title:"成功",message:"宣传图信息更新成功",type:"success"})):t.$notify({title:"错误",message:e.data.message,type:"error"})}).catch(function(e){a.close(),t.$msg.error(e)})}})},cancelChange:function(e){this.dialogFormVisible=!1,this.$refs[e].resetFields(),this.$notify({title:"操作取消",message:"",type:"success"})},uploadSuccess:function(e){200===e.code?(this.$msg.success("宣传图上传成功！"),this.alterForm.bannerUrl=e.data,this.$refs.bannerUpload.clearFiles()):this.$msg.error("宣传图上传失败！")},addBanner:function(){this.alterForm.productName="",this.alterForm.productUrl="",this.alterForm.bannerUrl="",this.insert=!0,this.dialogFormVisible=!0},reqInfo:function(){var e=this,t=this.$loading({lock:!0,text:"数据加载中",background:"rgba(255,255,255,0.1)"});this.$http.post("/banner/findAll").then(function(r){t.close(),200===r.data.code&&(e.slideShowResource=e.slideShow=r.data.data)}).catch(function(r){t.close(),e.$msg.error(r)})}},created:function(){this.reqInfo()}},a,!1,function(e){r("Lmsw")},null,null);t.default=s.exports}});
//# sourceMappingURL=26.d8c8c9089974c2ff5176.js.map