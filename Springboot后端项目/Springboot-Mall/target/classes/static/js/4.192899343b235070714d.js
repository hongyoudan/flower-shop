webpackJsonp([4],{Hpao:function(e,t){},IZfQ:function(e,t){},KSIE:function(e,t){},tBNf:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={name:"Register_Form",components:{AuthCode:o("vAh7").a},data:function(){var e=this;return{dialogVisible:!1,sendCodeIsUsed:!1,show:!0,count:"",timer:null,loadForm:{username:"",mailbox:"",authcode:"",password:""},rules:{username:[{validator:function(e,t,o){return t?t.length>20?o(new Error("昵称最长为20位！")):void o():o(new Error("请输入昵称！"))},trigger:"blur"}],mailbox:[{validator:function(t,o,i){if(0===o.length)e.sendCodeIsUsed=!1,i(new Error("请输入邮箱"));else{if(!new RegExp("^[A-Za-z0-9.一-龥_]+@[a-zA-Z0-9_-]+(\\.[a-zA-Z0-9_-]+)+$").test(o))return e.sendCodeIsUsed=!1,i(new Error("邮箱格式错误"));e.$http.post("/allow/existUser?accountNumber="+o).then(function(t){200===t.data.code&&(t.data.data?(e.sendCodeIsUsed=!1,i(new Error("邮箱已被注册"))):(e.sendCodeIsUsed=!0,i()))}).catch(function(e){console.log(e)})}},trigger:"blur"}],authcode:[{validator:function(e,t,o){0===t.length?o(new Error("请输入验证码")):o()},trigger:"blur"}],password:[{validator:function(e,t,o){if(0===t.length)o(new Error("请输入密码"));else{if(!new RegExp("^[a-zA-Z][a-zA-Z0-9_-]{5,18}$").test(t))return o(new Error("密码必须由数字和字母组合成,长度为6-18"));o(),o()}},trigger:"blur"}]}}},methods:{send:function(){var e=this;this.timer||(this.count=60,this.show=!1,this.timer=setInterval(function(){e.count>0&&e.count<=60?e.count--:(e.show=!0,clearInterval(e.timer),e.timer=null)},1e3))},submitCode:function(){var e=this;this.$refs.child.submitForm("codeForm")&&(this.dialogVisible=!1,this.$refs.child.resetForm("codeForm"),this.$http.post("/allow/sendHtmlCode?sendTo="+this.loadForm.mailbox).then(function(t){200===t.data.code?(e.send(),e.sendCodeIsUsed=!1,e.$msg.success(t.data.message)):500===t.data.code&&e.$msg.warning(t.data.message)}).catch(function(t){console.log(t),e.$msg.error("验证码发送失败，请稍后重试！")}))},cancelCode:function(){this.$refs.child.resetForm("codeForm"),this.dialogVisible=!1},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.$http.post("/allow/checkCode?key="+t.loadForm.mailbox+"&code="+t.loadForm.authcode).then(function(e){if(200===e.data.code)if(e.data.data){var o=t.$loading({lock:!0,text:"数据提交中",background:"rgba(255,255,255,0.1)"});t.$http.post("/allow/add?accountNumber="+t.loadForm.mailbox+"&password="+t.loadForm.password+"&userName="+t.loadForm.username).then(function(e){o.close(),200===e.data.code?(t.$msg.success({message:e.data.message,duration:1500}),t.$http.post("/allow/sendHtmlRegister?sendTo="+t.loadForm.mailbox+"&pwd="+t.loadForm.password+"&name="+t.loadForm.username),t.$router.push("/loginForm")):t.$msg.error({message:e.data.message,showClose:!0,duration:1500})}).catch(function(){o.close(),t.$msg.error({message:"注册失败，请稍后再试~",showClose:!0,duration:1500})})}else t.$msg.warning({message:e.data.message,duration:1500});else t.$msg.error({message:e.data.message,showClose:!0,duration:1500})}).catch(function(){t.$msg.error({message:"注册失败，请稍后再试~",showClose:!0,duration:1500})})})}}},r={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"register"},[o("el-form",{ref:"loadForm",staticClass:"demo-registerForm",attrs:{model:e.loadForm,rules:e.rules}},[o("el-form-item",{attrs:{prop:"username"}},[o("el-input",{staticClass:"el-input",attrs:{autocomplete:"on",placeholder:"请输入昵称"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitForm("loadForm")}},model:{value:e.loadForm.username,callback:function(t){e.$set(e.loadForm,"username",t)},expression:"loadForm.username"}},[o("i",{staticClass:"el-input__icon el-icon-user",attrs:{slot:"prefix"},slot:"prefix"})])],1),e._v(" "),o("el-form-item",{attrs:{prop:"mailbox"}},[o("el-input",{staticClass:"el-input",attrs:{autocomplete:"on",placeholder:"请输入邮箱"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitForm("loadForm")}},model:{value:e.loadForm.mailbox,callback:function(t){e.$set(e.loadForm,"mailbox",t)},expression:"loadForm.mailbox"}},[o("i",{staticClass:"el-input__icon el-icon-message",attrs:{slot:"prefix"},slot:"prefix"})])],1),e._v(" "),o("el-form-item",{staticStyle:{"text-align":"left"},attrs:{prop:"authcode"}},[o("el-input",{staticClass:"el-input",staticStyle:{width:"66%"},attrs:{"auto-complete":"“new-accounts”",maxlength:"6",autocomplete:"off",placeholder:"请输入邮箱验证码"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitForm("loadForm")}},model:{value:e.loadForm.authcode,callback:function(t){e.$set(e.loadForm,"authcode",t)},expression:"loadForm.authcode"}},[o("i",{staticClass:"el-input__icon el-icon-connection",attrs:{slot:"prefix"},slot:"prefix"})]),e._v(" "),o("el-button",{staticStyle:{position:"absolute",margin:"4px 6px",width:"88px"},attrs:{type:"success",plain:"",size:"small",disabled:!e.sendCodeIsUsed},on:{click:function(t){e.dialogVisible=!0}}},[o("span",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}]},[e._v("获取验证码")]),e._v(" "),o("span",{directives:[{name:"show",rawName:"v-show",value:!e.show,expression:"!show"}],staticClass:"count"},[e._v(e._s(e.count)+" s")])])],1),e._v(" "),o("el-dialog",{attrs:{title:"请输入验证码",visible:e.dialogVisible,width:"90%",top:"0",modal:!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[o("span",[o("AuthCode",{ref:"child"})],1),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:e.cancelCode}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.submitCode}},[e._v("确 定")])],1)]),e._v(" "),o("el-form-item",{staticStyle:{"margin-bottom":"24px"},attrs:{prop:"password"}},[o("el-input",{staticClass:"el-input",attrs:{autocomplete:"off",type:"password",placeholder:"请输入密码（字母开头，6~20位字符）"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitForm("loadForm")}},model:{value:e.loadForm.password,callback:function(t){e.$set(e.loadForm,"password",t)},expression:"loadForm.password"}},[o("i",{staticClass:"el-input__icon el-icon-lock",attrs:{slot:"prefix"},slot:"prefix"})])],1),e._v(" "),o("router-link",{attrs:{to:"/loginForm"}},[o("a",{staticClass:"register-a"},[e._v("已有账户")])]),e._v(" "),o("el-form-item",[o("el-button",{staticClass:"el-form-button",attrs:{type:"primary",plain:""},on:{click:function(t){return e.submitForm("loadForm")}}},[e._v("注册")])],1)],1)],1)},staticRenderFns:[]};var n=o("VU/8")(i,r,!1,function(e){o("KSIE")},null,null);t.default=n.exports},vAh7:function(e,t,o){"use strict";var i={name:"SIdentify",props:{identifyCode:{type:String,default:"1234"},fontSizeMin:{type:Number,default:25},fontSizeMax:{type:Number,default:30},backgroundColorMin:{type:Number,default:255},backgroundColorMax:{type:Number,default:255},colorMin:{type:Number,default:50},colorMax:{type:Number,default:160},lineColorMin:{type:Number,default:40},lineColorMax:{type:Number,default:180},contentWidth:{type:Number,default:90},contentHeight:{type:Number,default:38}},methods:{randomNum:function(e,t){return Math.floor(Math.random()*(t-e)+e)},randomColor:function(e,t){return"rgb("+this.randomNum(e,t)+","+this.randomNum(e,t)+","+this.randomNum(e,t)+")"},drawPic:function(){var e=document.getElementById("s-canvas").getContext("2d");e.textBaseline="bottom",e.fillStyle=this.randomColor(this.backgroundColorMin,this.backgroundColorMax),e.fillRect(0,0,this.contentWidth,this.contentHeight);for(var t=0;t<this.identifyCode.length;t++)this.drawText(e,this.identifyCode[t],t);this.drawLine(e)},drawText:function(e,t,o){e.fillStyle=this.randomColor(this.colorMin,this.colorMax),e.font=this.randomNum(this.fontSizeMin,this.fontSizeMax)+"px 黑体 border";var i=(o+1)*(this.contentWidth/(this.identifyCode.length+1)),r=this.randomNum(this.fontSizeMax,this.contentHeight-5),n=this.randomNum(-45,45);e.translate(i,r),e.rotate(n*Math.PI/180),e.fillText(t,0,0),e.rotate(-n*Math.PI/180),e.translate(-i,-r)},drawLine:function(e){for(var t=0;t<2;t++)e.strokeStyle=this.randomColor(this.lineColorMin,this.lineColorMax),e.beginPath(),e.moveTo(this.randomNum(0,this.contentWidth),this.randomNum(0,this.contentHeight)),e.lineTo(this.randomNum(0,this.contentWidth),this.randomNum(0,this.contentHeight)),e.stroke()}},watch:{identifyCode:function(){this.drawPic()}},mounted:function(){this.drawPic()}},r={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"s-canvas"},[t("canvas",{attrs:{id:"s-canvas",width:this.contentWidth,height:this.contentHeight}})])},staticRenderFns:[]};var n={name:"AuthCode",data:function(){var e=this;return{isCodeTrue:!1,codeForm:{verifyCode:""},identifyCodes:"1234567890",identifyCode:"",loginRules:{verifyCode:[{required:!0,trigger:"blur",validator:function(t,o,i){""===o?(i(new Error("请输入验证码")),e.isCodeTrue=!1):o!==e.identifyCode?(e.isCodeTrue=!1,i(new Error("验证码不正确"))):i()}}]}}},components:{SIdentify:o("VU/8")(i,r,!1,function(e){o("IZfQ")},null,null).exports},created:function(){},mounted:function(){this.identifyCode="",this.makeCode(this.identifyCodes,4)},computed:{},methods:{submitForm:function(e){var t=this;return this.$refs[e].validate(function(e){if(!e)return!1;t.isCodeTrue=!0}),this.isCodeTrue},resetForm:function(e){this.$refs[e].resetFields()},randomNum:function(e,t){return Math.floor(Math.random()*(t-e)+e)},refreshCode:function(){this.identifyCode="",this.makeCode(this.identifyCodes,4)},makeCode:function(e,t){for(var o=0;o<t;o++)this.identifyCode+=this.identifyCodes[this.randomNum(0,this.identifyCodes.length)]}}},s={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"randomised",staticStyle:{"user-select":"none"}},[o("el-form",{ref:"codeForm",staticClass:"login-form",attrs:{inline:"","status-icon":"",rules:e.loginRules,model:e.codeForm,"label-width":"50px"},nativeOn:{submit:function(e){e.preventDefault()}}},[o("el-form-item",{staticStyle:{"margin-right":"0"},attrs:{prop:"verifyCode"}},[o("el-input",{staticStyle:{"user-select":"text"},attrs:{size:"small",placeholder:"请输入验证码"},model:{value:e.codeForm.verifyCode,callback:function(t){e.$set(e.codeForm,"verifyCode",t)},expression:"codeForm.verifyCode"}})],1),e._v(" "),o("el-form-item",[o("div",{staticClass:"identifyBox"},[o("div",{on:{click:e.refreshCode}},[o("s-identify",{attrs:{identifyCode:e.identifyCode}})],1),e._v(" "),o("el-button",{attrs:{type:"text"},on:{click:e.refreshCode}},[e._v("看不清，换一张")])],1)])],1)],1)},staticRenderFns:[]};var a=o("VU/8")(n,s,!1,function(e){o("Hpao")},null,null);t.a=a.exports}});
//# sourceMappingURL=4.192899343b235070714d.js.map