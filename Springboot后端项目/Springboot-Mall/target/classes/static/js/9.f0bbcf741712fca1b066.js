webpackJsonp([9],{DdJ0:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"order-list"},[t("el-card",{staticClass:"box-card order-list-card",attrs:{shadow:"never"}},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("i",{staticClass:"el-icon-search"}),e._v(" "),t("span",[e._v("筛选搜索")]),e._v(" "),t("el-button",{staticClass:"el-button-search",attrs:{type:"primary"},on:{click:function(r){return e.queryOrder(e.orderSource)}}},[e._v("查询")]),e._v(" "),t("el-button",{staticClass:"el-button-search",on:{click:function(r){return e.resetForm("queryForm")}}},[e._v("重置")])],1),e._v(" "),t("el-form",{ref:"queryForm",staticClass:"el-form",attrs:{model:e.queryForm,inline:""}},[t("el-form-item",{attrs:{label:"订单编号：",prop:"orderNo"}},[t("el-input",{attrs:{placeholder:"订单编号"},model:{value:e.queryForm.orderNo,callback:function(r){e.$set(e.queryForm,"orderNo",r)},expression:"queryForm.orderNo"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"商品编号：",prop:"productNo"}},[t("el-input",{attrs:{placeholder:"商品编号"},model:{value:e.queryForm.productNo,callback:function(r){e.$set(e.queryForm,"productNo",r)},expression:"queryForm.productNo"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"收货人：",prop:"user"}},[t("el-input",{attrs:{placeholder:"收货人姓名/手机号"},model:{value:e.queryForm.user,callback:function(r){e.$set(e.queryForm,"user",r)},expression:"queryForm.user"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"订单状态：",prop:"orderState"}},[t("el-select",{attrs:{filterable:"",placeholder:"全部",clearable:""},model:{value:e.queryForm.orderState,callback:function(r){e.$set(e.queryForm,"orderState",r)},expression:"queryForm.orderState"}},e._l(e.orderStates,function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})}),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"支付方式：",prop:"payType"}},[t("el-select",{attrs:{placeholder:"全部",clearable:""},model:{value:e.queryForm.payType,callback:function(r){e.$set(e.queryForm,"payType",r)},expression:"queryForm.payType"}},e._l(e.payType,function(e,r){return t("el-option",{key:r,attrs:{label:e,value:e}})}),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"订单来源：",prop:"orderFrom"}},[t("el-select",{attrs:{placeholder:"全部",clearable:""},model:{value:e.queryForm.orderFrom,callback:function(r){e.$set(e.queryForm,"orderFrom",r)},expression:"queryForm.orderFrom"}},e._l(e.orderFrom,function(e,r){return t("el-option",{key:r,attrs:{label:e,value:e}})}),1)],1)],1)],1),e._v(" "),t("el-card",{staticClass:"box-card order-list-card",attrs:{shadow:"never"}},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("i",{staticClass:"el-icon-coin"}),e._v(" "),t("span",[e._v("数据列表")])]),e._v(" "),t("div",[t("el-table",{staticStyle:{width:"100%"},attrs:{slot:"empty",data:e.tableData,height:"500px",border:"",stripe:"","highlight-current-row":""},slot:"empty"},[t("el-table-column",{attrs:{prop:"orderId",label:"编号",align:"center",width:"50"}}),e._v(" "),t("el-table-column",{attrs:{prop:"orderNo",label:"订单编号",align:"center",width:"140"}}),e._v(" "),t("el-table-column",{attrs:{prop:"orderTime",label:"提交时间",align:"center",width:"180"}}),e._v(" "),t("el-table-column",{attrs:{prop:"productNo",label:"商品编号",align:"center",width:"180"}}),e._v(" "),t("el-table-column",{attrs:{label:"用户名称",align:"center",width:"140"},scopedSlots:e._u([{key:"default",fn:function(r){return[e.tableData?t("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right",content:"帐号："+e.tableData[r.$index].userAccount+", 联系方式："+e.tableData[r.$index].contactWay+", 地址："+e.tableData[r.$index].acceptAddress}},[t("p",{staticStyle:{cursor:"pointer"},domProps:{textContent:e._s(e.tableData[r.$index].userName)}})]):e._e()]}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"payPrice",label:"订单金额",align:"center",width:"140"}}),e._v(" "),t("el-table-column",{attrs:{prop:"payType",label:"支付方式",align:"center",width:"140"}}),e._v(" "),t("el-table-column",{attrs:{prop:"orderFrom",label:"订单来源",align:"center",width:"140"}}),e._v(" "),t("el-table-column",{attrs:{prop:"orderState",label:"订单状态",align:"center",width:"140"}}),e._v(" "),t("el-table-column",{attrs:{label:"操作",align:"center","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(r){return["待发货"===e.tableData[r.$index].orderState?t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.sendGoods(r.$index)}}},[e._v("确认发货")]):t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.orderInfo(r.$index)}}},[e._v("订单详情")])]}}])})],1),e._v(" "),t("div",{staticClass:"block"},[t("el-pagination",{attrs:{"page-sizes":e.pageSizes,"page-size":e.pageSize,"current-page":e.pageIndex,layout:"total, sizes, prev, pager, next, jumper",total:e.orderTotal},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)]),e._v(" "),t("el-dialog",{staticClass:"logistics",attrs:{title:"物流信息","close-on-click-modal":!1,visible:e.dialogFormVisible,width:"800px",center:""},on:{"update:visible":function(r){e.dialogFormVisible=r}}},[t("el-form",{ref:"changeFrom",staticClass:"info-form",attrs:{inline:"",rules:e.alterRules,model:e.alterForm}},[t("el-form-item",{attrs:{label:"订单编号：",prop:"orderNo"}},[t("el-input",{attrs:{size:"small",readonly:"",placeholder:"订单编号"},model:{value:e.alterForm.orderNo,callback:function(r){e.$set(e.alterForm,"orderNo",r)},expression:"alterForm.orderNo"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"快递公司：",prop:"parcelName"}},[t("el-select",{attrs:{size:"small",filterable:"",placeholder:"快递公司"},model:{value:e.alterForm.parcelName,callback:function(r){e.$set(e.alterForm,"parcelName",r)},expression:"alterForm.parcelName"}},e._l(e.Parcel,function(e,r){return t("el-option",{key:r,attrs:{label:e,value:e}})}),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"收货人：",prop:"receiver"}},[t("el-input",{attrs:{size:"small",placeholder:"收货人"},model:{value:e.alterForm.receiver,callback:function(r){e.$set(e.alterForm,"receiver",r)},expression:"alterForm.receiver"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"收货人联系方式：",prop:"receiverTel"}},[t("el-input",{attrs:{size:"small",placeholder:"收货人联系方式"},model:{value:e.alterForm.receiverTel,callback:function(r){e.$set(e.alterForm,"receiverTel",r)},expression:"alterForm.receiverTel"}})],1),e._v(" "),t("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"收货人地址：",prop:"contactWay"}},[t("el-input",{attrs:{size:"small",placeholder:"收货人地址"},model:{value:e.alterForm.receiverAdd,callback:function(r){e.$set(e.alterForm,"receiverAdd",r)},expression:"alterForm.receiverAdd"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"发货人：",prop:"sender"}},[t("el-input",{attrs:{size:"small",placeholder:"发货人"},model:{value:e.alterForm.sender,callback:function(r){e.$set(e.alterForm,"sender",r)},expression:"alterForm.sender"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"发货人联系方式：",prop:"senderTel"}},[t("el-input",{attrs:{size:"small",placeholder:"发货人联系方式"},model:{value:e.alterForm.senderTel,callback:function(r){e.$set(e.alterForm,"senderTel",r)},expression:"alterForm.senderTel"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"发货人地址：",prop:"senderAdd"}},[t("el-input",{attrs:{size:"small",placeholder:"发货人地址"},model:{value:e.alterForm.senderAdd,callback:function(r){e.$set(e.alterForm,"senderAdd",r)},expression:"alterForm.senderAdd"}})],1)],1),e._v(" "),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{staticStyle:{padding:"12px 30px",margin:"0 30px"},attrs:{type:"primary"},on:{click:function(r){return e.submitInfo("changeFrom")}}},[e._v("确 定")]),e._v(" "),t("el-button",{staticStyle:{padding:"12px 30px",margin:"0 30px"},on:{click:function(r){return e.cancelChange("changeFrom")}}},[e._v("取 消")])],1)],1)],1)},staticRenderFns:[]};var l=t("VU/8")({name:"OrderList",data:function(){return{Sender:"花卷",SenderTel:"400-626-1123",SenderAdd:"河北师范大学",Parcel:["花卷物流","邮政快递","中通快递","圆通快递","百世快递"],dialogFormVisible:!1,handleIndex:0,orderTotal:0,pageIndex:1,pageSize:10,pageSizes:[5,10,30,60,100,200,400],orderSource:{},orderTemp:{},queryForm:{orderNo:"",productNo:"",user:"",orderState:"",payType:"",orderFrom:""},alterForm:{orderNo:"",receiver:"",receiverTel:"",receiverAdd:"",sender:"",senderTel:"",senderAdd:"",parcelName:"花卷物流"},alterRules:{parcelName:[{required:!0,message:"请选择物流公司",trigger:"blur"}],receiver:[{required:!0,message:"请填写收货人",trigger:"blur"},{min:1,max:30,message:"名称长度不允许超过 30 个字符",trigger:"blur"}],receiverTel:[{required:!0,message:"请填写收货人联系方式",trigger:"blur"},{min:1,max:11,message:"请填写正确的联系方式",trigger:"blur"}],receiverAdd:[{required:!0,message:"请填写收货人地址",trigger:"blur"},{min:1,max:30,message:"地址不允许超过30个字符",trigger:"blur"}],sender:[{required:!0,message:"请填写收货人",trigger:"blur"},{min:1,max:30,message:"名称长度不允许超过 30 个字符",trigger:"blur"}],senderTel:[{required:!0,message:"请填写收货人联系方式",trigger:"blur"},{min:1,max:12,message:"请填写正确的联系方式",trigger:"blur"}],senderAdd:[{required:!0,message:"请填写收货人地址",trigger:"blur"},{min:1,max:30,message:"地址不允许超过30个字符",trigger:"blur"}]},orderStates:["待付款","待发货","已发货","已收货","已评价","开通成功"],payType:["微信","支付宝"],orderFrom:["APP订单","网页商城"],tableData:[]}},created:function(){this.reqInfo()},methods:{sendGoods:function(e){this.alterForm.orderNo=this.tableData[e].orderNo,this.alterForm.receiver=this.tableData[e].userName,this.alterForm.receiverTel=this.tableData[e].contactWay,this.alterForm.receiverAdd=this.tableData[e].acceptAddress,this.alterForm.sender=this.Sender,this.alterForm.senderTel=this.SenderTel,this.alterForm.senderAdd=this.SenderAdd,this.handleIndex=e,this.dialogFormVisible=!0},submitInfo:function(e){var r=this;this.$refs[e].validate(function(e){if(!e)return!1;var t=r.$loading({lock:!0,text:"数据提交中",background:"rgba(255,255,255,0.2)"});r.$http.post("/logistics/addInfo",r.$qs.stringify(r.alterForm)).then(function(e){if(200===e.data.code){var a=r.tableData[r.handleIndex].orderId;r.$http.post("/order/update?orderId="+a+"&orderState=已发货").then(function(e){200===e.data.code?(t.close(),r.reqInfo(),r.dialogFormVisible=!1,r.$notify({title:"成功",message:"物流信息更新成功",type:"success"})):r.$msg.error(e.data.message)}).catch(function(e){r.$msg.error(e)})}else r.$msg.error(e.data.message)}).catch(function(e){r.$msg.error(e)})})},cancelChange:function(e){this.$refs[e].resetFields(),this.dialogFormVisible=!1},orderInfo:function(e){var r=this.tableData[e].orderNo;this.$router.push({path:"/OrderDetail",query:{orderNo:r,state:"0"}})},isSaleState:function(e){var r=this;this.$http.post("/product/update?productId="+this.tableData[e].productId+"&isSale="+this.tableData[e].isSale).then(function(t){200===t.data.code&&(r.tableData[e].isSale?r.$notify({title:"成功",message:r.tableData[e].productName+"\t已上架",type:"success"}):r.$notify({title:"成功",message:r.tableData[e].productName+"\t已下架",type:"success"}))}).catch(function(e){r.$msg.error(e)})},isNewState:function(e){var r=this;this.$http.post("/product/update?productId="+this.tableData[e].productId+"&isSale="+this.tableData[e].isNew).then(function(t){200===t.data.code&&(r.tableData[e].isNew?r.$notify({title:"成功",message:r.tableData[e].productName+"\t设为新品",type:"success"}):r.$notify({title:"成功",message:r.tableData[e].productName+"\t设为正常",type:"success"}))}).catch(function(e){r.$msg.error(e)})},resetForm:function(e){this.$refs[e].resetFields()},queryOrder:function(e){this.orderTemp=[];var r=this.queryForm,t=0;if(0===r.orderNo.length&&0===r.productNo.length&&0===r.user.length&&0===r.orderState.length&&0===r.payType.length&&0===r.orderFrom.length)this.orderTemp=this.orderSource,this.orderTotal=this.orderSource.length;else{for(var a=0;a<e.length;a++)0!==r.orderNo.length&&e[a].orderNo===r.orderNo&&(this.orderTemp.push(e[a]),t++),0!==r.productNo.length&&e[a].productNo===r.productNo&&(this.orderTemp.push(e[a]),t++),0!==r.user.length&&(-1!==e[a].userName.indexOf(r.user)?(this.orderTemp.push(e[a]),t++):-1!==e[a].contactWay.indexOf(r.user)&&(this.orderTemp.push(e[a]),t++)),0!==r.orderState.length&&-1!==e[a].orderState.indexOf(r.orderState)&&(this.orderTemp.push(e[a]),t++),0!==r.payType.length&&-1!==e[a].payType.indexOf(r.payType)&&(this.orderTemp.push(e[a]),t++),0!==r.orderFrom.length&&-1!==e[a].orderFrom.indexOf(r.orderFrom)&&(this.orderTemp.push(e[a]),t++);this.orderTotal=t}this.handleSizeChange(this.pageSize)},handleSizeChange:function(e){this.pageSize=e,this.handleCurrentChange(this.pageIndex)},handleCurrentChange:function(e){this.pageIndex=e,this.currentChangePage(this.orderTemp,e)},currentChangePage:function(e,r){var t=(r-1)*this.pageSize,a=r*this.pageSize;for(a>this.orderTotal&&(a=this.orderTotal),this.tableData=[];t<a;t++)this.tableData.push(e[t])},reqInfo:function(){var e=this,r=this.$loading({lock:!0,text:"数据加载中",spinner:"el-icon-loading",background:"rgba(255,255,255,0.1)"});this.$http.post("/order/findCount").then(function(t){200===t.data.code?(r.close(),e.pageSize=e.orderTotal=t.data.data,e.pageSizes.push(e.orderTotal),e.$http.post("/order/findAll").then(function(r){200===r.data.code?(e.tableData=r.data.data,e.orderSource=e.orderTemp=e.tableData,e.handleSizeChange(e.pageSize)):e.$msg.error(r.data.message)}).catch(function(t){r.close(),e.$msg.error(t)})):e.$msg.error(t.data.message)}).catch(function(r){e.$msg.error(r)})}}},a,!1,function(e){t("L7D9")},null,null);r.default=l.exports},L7D9:function(e,r){}});
//# sourceMappingURL=9.f0bbcf741712fca1b066.js.map