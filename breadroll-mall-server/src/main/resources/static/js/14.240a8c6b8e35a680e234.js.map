{"version":3,"sources":["webpack:///src/components/user/UserList.vue","webpack:///./src/components/user/UserList.vue?af0f","webpack:///./src/components/user/UserList.vue"],"names":["UserList","name","data","userInfo","VAR","this","$VAR","operateRole","$store","state","role","operateId","user","userId","userInfoResource","userDialogVisible","roleInfo","handleIndex","currentRole","currentRoleName","allotRoles","userInfoForm","key","methods","queryUser","length","i","len","userName","indexOf","push","accountNumber","resetForm","formName","$refs","resetFields","isUserState","index","_this","loading","$loading","lock","text","background","$http","post","userState","then","rep","close","code","$notify","title","message","type","catch","err","$msg","error","allotRole","_this2","userRole","roleName","roleId","_i","deleteUser","rows","_this3","$confirm","confirmButtonText","cancelButtonText","splice","reqInfo","_this4","filter","item","adminRole","ordinaryRole","submitRole","_this5","$alert","_i2","j","substring","console","log","created","user_UserList","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","shadow","staticStyle","text-align","slot","_v","right","on","click","$event","ref","model","inline","label","prop","clearable","placeholder","nativeOn","keyup","_k","keyCode","value","callback","$$v","$set","expression","position","width","height","border","scopedSlots","_u","fn","scope","disabled","row","change","$index","align","min-width","margin","size","visible","distinguishCancelAndClose","update:visible","margin-top","effect","content","placement","_s","_e","multiple","_l","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/14.240a8c6b8e35a680e234.js","sourcesContent":["<template>\r\n  <div class=\"user-list\">\r\n    <el-card class=\"user-hd\" shadow=\"never\">\r\n      <div slot=\"header\" style=\"text-align: left;\">\r\n        <i class=\"el-icon-search\"/>\r\n        <span>筛选搜索</span>\r\n        <el-button class=\"el-button-search\" style=\"right: 111px\" type=\"primary\" @click=\"queryUser()\">查询</el-button>\r\n        <el-button class=\"el-button-search\" style=\"right: 20px\" @click=\"resetForm('userInfoForm')\">重置</el-button>\r\n      </div>\r\n      <el-form :model=\"userInfoForm\" ref=\"userInfoForm\" inline class=\"query-form\">\r\n        <el-form-item label=\"输入搜索\" prop=\"key\">\r\n          <el-input v-model=\"userInfoForm.key\" @keyup.enter.native=\"queryUser()\" clearable\r\n                    placeholder=\"帐号/姓名\"></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n    </el-card>\r\n    <el-card class=\"user-box\" shadow=\"never\">\r\n      <div slot=\"header\" style=\"text-align: left;position: relative\">\r\n        <i class=\"el-icon-coin\"/>\r\n        <span>数据列表</span>\r\n      </div>\r\n      <el-table :data=\"userInfo\" class=\"type-table\" height=\"425\" border style=\"width: 100%\">\r\n        <el-table-column prop=\"userId\" label=\"编号\" width=\"100\"></el-table-column>\r\n        <el-table-column prop=\"accountNumber\" label=\"帐号\" width=\"200\"></el-table-column>\r\n        <el-table-column prop=\"userName\" label=\"姓名\" width=\"150\"></el-table-column>\r\n        <el-table-column prop=\"telephone\" label=\"手机号\" width=\"200\"></el-table-column>\r\n        <el-table-column prop=\"creatTime\" label=\"注册时间\" width=\"200\"></el-table-column>\r\n        <el-table-column prop=\"loginTime\" label=\"最后登录\" width=\"200\"></el-table-column>\r\n        <el-table-column label=\"是否启用\" width=\"100\">\r\n          <template slot-scope=\"scope\">\r\n            <el-switch :disabled=\"operateId===scope.row.userId||scope.row.userName===VAR.adminRole\"\r\n                       @change=\"isUserState(scope.$index)\" v-model=\"userInfo[scope.$index].userState\"/>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"操作\" align=\"center\" min-width=\"200\">\r\n          <template slot-scope=\"scope\">\r\n            <el-button size=\"mini\" style=\"margin: 0 2%\" @click=\"allotRole(scope.$index)\">分配角色</el-button>\r\n            <el-button size=\"mini\" type=\"danger\" title=\"超级管理员才有删除权限\"\r\n                       :disabled=\"((operateId===scope.row.userId) || (operateRole!==null && operateRole.indexOf(VAR.adminRole)===-1))\"\r\n                       style=\"margin: 0 2%\" @click=\"deleteUser(scope.$index, userInfo)\">删除</el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n    </el-card>\r\n    <el-dialog title=\"分配角色\" class=\"user-dialog\" :visible.sync=\"userDialogVisible\" width=\"30%\" distinguishCancelAndClose>\r\n      <div style=\"text-align: left;width: 80%;margin: 0 auto\">\r\n        <h3 style=\"margin-top: 0\" v-if=\"userInfo.length!==0\">姓名:\r\n          <el-tooltip effect=\"dark\" :content=\"currentRoleName\" placement=\"right\">\r\n            <el-tag v-if=\"currentRoleName.indexOf(VAR.adminRole)!==-1\" type=\"warning\">\r\n              {{ userInfo[handleIndex]['userName'] }}\r\n            </el-tag>\r\n            <el-tag v-else-if=\"currentRoleName.indexOf(VAR.ordinaryRole)!==-1\" type=\"success\">\r\n              {{ userInfo[handleIndex]['userName'] }}\r\n            </el-tag>\r\n            <el-tag v-else-if=\"currentRoleName.indexOf('暂无角色信息')!==-1\" type=\"info\">\r\n              {{ userInfo[handleIndex]['userName'] }}\r\n            </el-tag>\r\n            <el-tag v-else type=\"danger\">{{ userInfo[handleIndex]['userName'] }}</el-tag>\r\n          </el-tooltip>\r\n        </h3>\r\n        <el-select v-model=\"allotRoles\" multiple placeholder=\"请选择角色\" style=\"width: 100%;\">\r\n          <el-option v-for=\"item in roleInfo\" :key=\"item.roleId\" :label=\"item.roleName\"\r\n                     :value=\"item.roleId\"></el-option>\r\n        </el-select>\r\n      </div>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button size=\"small\" @click=\"userDialogVisible = false\">取 消</el-button>\r\n        <el-button size=\"small\" type=\"primary\" @click=\"submitRole\">确 定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"UserList\",\r\n  data: function () {\r\n    return {\r\n      userInfo: [],\r\n      VAR: this.$VAR,\r\n      operateRole: this.$store.state.role,\r\n      operateId: this.$store.state.user.userId,\r\n      userInfoResource: [],\r\n      userDialogVisible: false,\r\n      roleInfo: [],\r\n      handleIndex: 0,\r\n      currentRole: [],\r\n      currentRoleName: '',\r\n      allotRoles: [],  //被分配的角色\r\n      userInfoForm: {\r\n        key: ''\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    queryUser() {\r\n      if (this.userInfoForm.key.length !== 0) {\r\n        this.userInfo = [];\r\n        for (let i = 0, len = this.userInfoResource.length; i < len; i++) {\r\n          if (this.userInfoResource[i].userName.indexOf(this.userInfoForm.key) !== -1) {\r\n            this.userInfo.push(this.userInfoResource[i]);\r\n          } else if (this.userInfoResource[i].accountNumber.indexOf(this.userInfoForm.key) !== -1) {\r\n            this.userInfo.push(this.userInfoResource[i]);\r\n          }\r\n        }\r\n      } else {\r\n        this.userInfo = this.userInfoResource;\r\n      }\r\n    },\r\n    resetForm(formName) {\r\n      this.$refs[formName].resetFields();\r\n    },\r\n    isUserState(index) {\r\n      let loading = this.$loading({lock: true, text: \"数据提交中\", background: \"rgba(255,255,255,0.1)\"});\r\n      this.$http.post('/allow/update?userId=' + this.userInfo[index].userId + '&userState=' + this.userInfo[index].userState).then((rep) => {\r\n        loading.close();\r\n        if (rep.data.code === 200) {\r\n          if (this.userInfo[index].userState) {\r\n            this.$notify({title: '成功', message: this.userInfo[index].userName + '\\t已启用', type: 'success'});\r\n          } else {\r\n            this.$notify({title: '成功', message: this.userInfo[index].userName + '\\t已禁用', type: 'success'});\r\n          }\r\n        }\r\n      }).catch((err) => {\r\n        loading.close();\r\n        this.$msg.error(err)\r\n      })\r\n    },\r\n    allotRole: function (index) {\r\n      this.handleIndex = index;\r\n      let userId = this.userInfo[index].userId;\r\n      this.$http.post('/userRole/findRoleById?userId=' + userId).then((rep) => {\r\n        if (rep.data.code === 200) {\r\n          let userRole = rep.data.data;\r\n          this.currentRole = rep.data.data;\r\n          this.currentRoleName = ''; //数组清空\r\n          for (let i = 0; i < this.currentRole.length; i++) {\r\n            this.currentRoleName += this.currentRole[i].roleName + '\\t';\r\n          }\r\n          if (this.currentRoleName.length === 0) {\r\n            this.currentRoleName = '暂无角色信息'\r\n          }\r\n          let roleId = [];\r\n          for (let i = 0; i < userRole.length; i++) {\r\n            if (userRole[i].roleId !== 5 && userRole[i].roleId !== 1) {\r\n              roleId.push(userRole[i].roleId)\r\n            }\r\n          }\r\n          this.allotRoles = roleId;\r\n        }\r\n      }).catch((err) => {\r\n        this.$msg.error(err);\r\n      })\r\n      this.userDialogVisible = true;\r\n    },\r\n    deleteUser(index, rows) {\r\n      this.$confirm('此操作将永久删除该用户信息, 是否继续?', '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      }).then(() => {\r\n        let loading = this.$loading({lock: true, text: \"数据提交中\", background: \"rgba(255,255,255,0.1)\"});\r\n        this.$http.post('/user/delete?userId=' + this.userInfo[index].userId).then((rep) => {\r\n          loading.close();\r\n          if (rep.data.code === 200) {\r\n            this.$notify({title: '成功', message: '用户（' + this.userInfo[index].userName + '）\\t删除成功', type: 'success'});\r\n            rows.splice(index, 1);//删掉该行\r\n          } else {\r\n            this.$notify({title: '错误', message: rep.data.message, type: 'error'});\r\n          }\r\n        }).catch((err) => {\r\n          loading.close();\r\n          this.$msg.error(err);\r\n        })\r\n      }).catch(() => {\r\n        this.$notify({title: '操作取消', message: '', type: 'success'});\r\n      });\r\n\r\n    },\r\n    reqInfo() {\r\n      this.$http.post('/user/findAll/customer').then((rep) => {\r\n        if (rep.data.code === 200) {\r\n          this.userInfo = this.userInfoResource = rep.data.data;\r\n        }\r\n      }).catch((err) => {\r\n        this.$msg.error(err)\r\n      })\r\n      this.$http.post('/role/findAllUsable').then((rep) => {\r\n        if (rep.data.code === 200) {\r\n          this.roleInfo = rep.data.data.filter((item) => {\r\n            return item.roleName !== VAR.adminRole && item.roleName !== VAR.ordinaryRole;\r\n          });\r\n        }\r\n      }).catch((err) => {\r\n        this.$msg.error(err)\r\n      })\r\n    },\r\n    submitRole() {\r\n      if (this.allotRoles.length === 0) {\r\n        this.$alert('至少选择一个角色', '提示', {\r\n          confirmButtonText: '确定',\r\n          type: \"warning\"\r\n        });\r\n      } else {\r\n        this.$confirm('是否要分配该角色?', '提示', {\r\n          confirmButtonText: '确定',\r\n          cancelButtonText: '取消',\r\n          type: 'warning'\r\n        }).then(() => {\r\n          let roleInfo = '';\r\n          for (let i = 0; i < this.currentRole.length; i++) {\r\n            if (this.currentRole[i].roleName.indexOf(this.$VAR.adminRole) !== -1) {\r\n              this.allotRoles.push(this.currentRole[i].roleId);\r\n              roleInfo += this.currentRole[i].roleName + '、 ';\r\n            }\r\n          }\r\n\r\n          for (let i = 0; i < this.allotRoles.length; i++) {\r\n            for (let j = 0; j < this.roleInfo.length; j++) {\r\n              if (this.allotRoles[i] === this.roleInfo[j].roleId) {\r\n                roleInfo += this.roleInfo[j].roleName + '、 ';\r\n              }\r\n            }\r\n          }\r\n          roleInfo = roleInfo.substring(0, roleInfo.length - 2);\r\n          console.log(roleInfo)\r\n          let loading = this.$loading({lock: true, text: \"数据提交中\", background: \"rgba(255,255,255,0.1)\"});\r\n          this.$http.post('/user/author?userId=' + this.userInfo[this.handleIndex].userId + '&roleId=' + this.allotRoles).then((rep) => {\r\n            loading.close();\r\n            if (rep.data.code === 200) {\r\n              this.$http.post('/allow/sendHtmlRole?email=' + this.userInfo[this.handleIndex].accountNumber +\r\n                '&userName=' + this.userInfo[this.handleIndex].userName + '&roleInfo=' + roleInfo);\r\n              this.userDialogVisible = false;\r\n              this.$notify({title: '成功', message: '\\t角色授权成功', type: 'success'});\r\n            } else {\r\n              this.$notify({title: '错误', message: rep.data.message, type: 'error'});\r\n            }\r\n          }).catch((err) => {\r\n            loading.close();\r\n            this.$msg.error(err)\r\n          })\r\n        }).catch(() => {\r\n        });\r\n      }\r\n    }\r\n  },\r\n  created() {\r\n    this.reqInfo();\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n.user-list {\r\n  margin: 0;\r\n  padding: 0;\r\n  min-height: 94%;\r\n  user-select: none;\r\n  min-width: 1226px;\r\n}\r\n\r\n.user-list .user-hd {\r\n  height: 138px;\r\n  margin: 30px auto 10px;\r\n  width: 95%;\r\n}\r\n\r\n.user-list .user-hd .el-card__header {\r\n  position: relative;\r\n}\r\n\r\n\r\n.user-list .info-box {\r\n  height: 600px;\r\n  border: 1px solid #EBEEF5;\r\n}\r\n\r\n.user-list .el-card__body {\r\n  user-select: text;\r\n}\r\n\r\n.user-list .user-hd .el-button-search {\r\n  position: absolute;\r\n  top: 14px;\r\n  padding: 3px 0;\r\n  width: 70px;\r\n  height: 30px;\r\n}\r\n\r\n.user-list .query-form {\r\n  text-align: left;\r\n}\r\n\r\n.user-list .user-box {\r\n  height: 530px;\r\n  margin: 20px auto 10px;\r\n  width: 95%;\r\n}\r\n\r\n.user-list .user-box th, .user-list .user-box td {\r\n  text-align: center;\r\n}\r\n\r\n.user-list .el-table th.gutter {\r\n  display: table-cell !important;\r\n}\r\n\r\n.user-list .info-form {\r\n  position: relative;\r\n}\r\n\r\n.user-list .user-dialog {\r\n  min-width: 200px;\r\n\r\n}\r\n\r\n.user-list .user-dialog .el-dialog__header {\r\n  text-align: left;\r\n}\r\n\r\n.user-list .user-dialog .el-dialog {\r\n  margin-top: 28vh !important;\r\n}\r\n\r\n.user-list .user-dialog .el-tag {\r\n  height: 28px;\r\n  line-height: 28px;\r\n  font-weight: 200;\r\n  padding: 0 4px;\r\n  cursor: pointer;\r\n}\r\n\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/user/UserList.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"user-list\"},[_c('el-card',{staticClass:\"user-hd\",attrs:{\"shadow\":\"never\"}},[_c('div',{staticStyle:{\"text-align\":\"left\"},attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('i',{staticClass:\"el-icon-search\"}),_vm._v(\" \"),_c('span',[_vm._v(\"筛选搜索\")]),_vm._v(\" \"),_c('el-button',{staticClass:\"el-button-search\",staticStyle:{\"right\":\"111px\"},attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.queryUser()}}},[_vm._v(\"查询\")]),_vm._v(\" \"),_c('el-button',{staticClass:\"el-button-search\",staticStyle:{\"right\":\"20px\"},on:{\"click\":function($event){return _vm.resetForm('userInfoForm')}}},[_vm._v(\"重置\")])],1),_vm._v(\" \"),_c('el-form',{ref:\"userInfoForm\",staticClass:\"query-form\",attrs:{\"model\":_vm.userInfoForm,\"inline\":\"\"}},[_c('el-form-item',{attrs:{\"label\":\"输入搜索\",\"prop\":\"key\"}},[_c('el-input',{attrs:{\"clearable\":\"\",\"placeholder\":\"帐号/姓名\"},nativeOn:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.queryUser()}},model:{value:(_vm.userInfoForm.key),callback:function ($$v) {_vm.$set(_vm.userInfoForm, \"key\", $$v)},expression:\"userInfoForm.key\"}})],1)],1)],1),_vm._v(\" \"),_c('el-card',{staticClass:\"user-box\",attrs:{\"shadow\":\"never\"}},[_c('div',{staticStyle:{\"text-align\":\"left\",\"position\":\"relative\"},attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('i',{staticClass:\"el-icon-coin\"}),_vm._v(\" \"),_c('span',[_vm._v(\"数据列表\")])]),_vm._v(\" \"),_c('el-table',{staticClass:\"type-table\",staticStyle:{\"width\":\"100%\"},attrs:{\"data\":_vm.userInfo,\"height\":\"425\",\"border\":\"\"}},[_c('el-table-column',{attrs:{\"prop\":\"userId\",\"label\":\"编号\",\"width\":\"100\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"accountNumber\",\"label\":\"帐号\",\"width\":\"200\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"userName\",\"label\":\"姓名\",\"width\":\"150\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"telephone\",\"label\":\"手机号\",\"width\":\"200\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"creatTime\",\"label\":\"注册时间\",\"width\":\"200\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"loginTime\",\"label\":\"最后登录\",\"width\":\"200\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"是否启用\",\"width\":\"100\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-switch',{attrs:{\"disabled\":_vm.operateId===scope.row.userId||scope.row.userName===_vm.VAR.adminRole},on:{\"change\":function($event){return _vm.isUserState(scope.$index)}},model:{value:(_vm.userInfo[scope.$index].userState),callback:function ($$v) {_vm.$set(_vm.userInfo[scope.$index], \"userState\", $$v)},expression:\"userInfo[scope.$index].userState\"}})]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"操作\",\"align\":\"center\",\"min-width\":\"200\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-button',{staticStyle:{\"margin\":\"0 2%\"},attrs:{\"size\":\"mini\"},on:{\"click\":function($event){return _vm.allotRole(scope.$index)}}},[_vm._v(\"分配角色\")]),_vm._v(\" \"),_c('el-button',{staticStyle:{\"margin\":\"0 2%\"},attrs:{\"size\":\"mini\",\"type\":\"danger\",\"title\":\"超级管理员才有删除权限\",\"disabled\":((_vm.operateId===scope.row.userId) || (_vm.operateRole!==null && _vm.operateRole.indexOf(_vm.VAR.adminRole)===-1))},on:{\"click\":function($event){return _vm.deleteUser(scope.$index, _vm.userInfo)}}},[_vm._v(\"删除\")])]}}])})],1)],1),_vm._v(\" \"),_c('el-dialog',{staticClass:\"user-dialog\",attrs:{\"title\":\"分配角色\",\"visible\":_vm.userDialogVisible,\"width\":\"30%\",\"distinguishCancelAndClose\":\"\"},on:{\"update:visible\":function($event){_vm.userDialogVisible=$event}}},[_c('div',{staticStyle:{\"text-align\":\"left\",\"width\":\"80%\",\"margin\":\"0 auto\"}},[(_vm.userInfo.length!==0)?_c('h3',{staticStyle:{\"margin-top\":\"0\"}},[_vm._v(\"姓名:\\n        \"),_c('el-tooltip',{attrs:{\"effect\":\"dark\",\"content\":_vm.currentRoleName,\"placement\":\"right\"}},[(_vm.currentRoleName.indexOf(_vm.VAR.adminRole)!==-1)?_c('el-tag',{attrs:{\"type\":\"warning\"}},[_vm._v(\"\\n            \"+_vm._s(_vm.userInfo[_vm.handleIndex]['userName'])+\"\\n          \")]):(_vm.currentRoleName.indexOf(_vm.VAR.ordinaryRole)!==-1)?_c('el-tag',{attrs:{\"type\":\"success\"}},[_vm._v(\"\\n            \"+_vm._s(_vm.userInfo[_vm.handleIndex]['userName'])+\"\\n          \")]):(_vm.currentRoleName.indexOf('暂无角色信息')!==-1)?_c('el-tag',{attrs:{\"type\":\"info\"}},[_vm._v(\"\\n            \"+_vm._s(_vm.userInfo[_vm.handleIndex]['userName'])+\"\\n          \")]):_c('el-tag',{attrs:{\"type\":\"danger\"}},[_vm._v(_vm._s(_vm.userInfo[_vm.handleIndex]['userName']))])],1)],1):_vm._e(),_vm._v(\" \"),_c('el-select',{staticStyle:{\"width\":\"100%\"},attrs:{\"multiple\":\"\",\"placeholder\":\"请选择角色\"},model:{value:(_vm.allotRoles),callback:function ($$v) {_vm.allotRoles=$$v},expression:\"allotRoles\"}},_vm._l((_vm.roleInfo),function(item){return _c('el-option',{key:item.roleId,attrs:{\"label\":item.roleName,\"value\":item.roleId}})}),1)],1),_vm._v(\" \"),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{attrs:{\"size\":\"small\"},on:{\"click\":function($event){_vm.userDialogVisible = false}}},[_vm._v(\"取 消\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"size\":\"small\",\"type\":\"primary\"},on:{\"click\":_vm.submitRole}},[_vm._v(\"确 定\")])],1)])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-6b307cc2\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/user/UserList.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-6b307cc2\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./UserList.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./UserList.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./UserList.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-6b307cc2\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./UserList.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/user/UserList.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}